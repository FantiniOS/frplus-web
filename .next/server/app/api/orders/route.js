"use strict";(()=>{var e={};e.id=9146,e.ids=[9146],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},31796:(e,t,a)=>{a.r(t),a.d(t,{headerHooks:()=>v,originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>P,staticGenerationAsyncStorage:()=>b,staticGenerationBailout:()=>I});var o={};a.r(o),a.d(o,{GET:()=>u,POST:()=>l,dynamic:()=>c});var r=a(95419),i=a(69108),n=a(99678),d=a(19631),s=a(78070);let c="force-dynamic";async function u(){try{let e=(await d._.pedido.findMany({include:{cliente:!0,itens:{include:{produto:!0}}},orderBy:{data:"desc"}})).map(e=>({id:e.id,clienteId:e.clienteId,nomeCliente:e.cliente.nomeFantasia,data:e.data.toISOString(),status:e.status,valorTotal:Number(e.valorTotal),tabelaPreco:e.tabelaPreco,condicaoPagamento:e.condicaoPagamento,observacoes:e.observacoes,itens:e.itens.map(e=>({id:e.id,produtoId:e.produtoId,nomeProduto:e.produto.nome,quantidade:e.quantidade,precoUnitario:Number(e.precoUnitario),total:Number(e.total)}))}));return s.Z.json(e)}catch(e){return console.error("Error fetching orders:",e),s.Z.json({error:"Failed to fetch orders"},{status:500})}}async function l(e){try{let t=await e.json(),a=t.itens.reduce((e,t)=>e+t.quantidade*t.precoUnitario,0),o=await d._.pedido.create({data:{clienteId:t.clienteId,fabricaId:t.fabricaId,status:"Pendente",valorTotal:a,tabelaPreco:t.tabelaPreco,condicaoPagamento:t.condicaoPagamento,observacoes:t.observacoes,itens:{create:t.itens.map(e=>({produtoId:e.produtoId,quantidade:e.quantidade,precoUnitario:e.precoUnitario,total:e.quantidade*e.precoUnitario}))}},include:{cliente:!0,itens:{include:{produto:!0}}}});return s.Z.json({id:o.id,clienteId:o.clienteId,nomeCliente:o.cliente.nomeFantasia,data:o.data.toISOString(),status:o.status,valorTotal:Number(o.valorTotal),itens:o.itens.map(e=>({id:e.id,produtoId:e.produtoId,nomeProduto:e.produto.nome,quantidade:e.quantidade,precoUnitario:Number(e.precoUnitario),total:Number(e.total)}))},{status:201})}catch(e){return console.error("Error creating order:",e),s.Z.json({error:"Failed to create order"},{status:500})}}let p=new r.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/orders/route",pathname:"/api/orders",filename:"route",bundlePath:"app/api/orders/route"},resolvedPagePath:"E:\\FRPlus\\frplus-web\\src\\app\\api\\orders\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:b,serverHooks:P,headerHooks:v,staticGenerationBailout:I}=p,g="/api/orders/route";function h(){return(0,n.patchFetch)({serverHooks:P,staticGenerationAsyncStorage:b})}},19631:(e,t,a)=>{a.d(t,{_:()=>r});let o=require("@prisma/client"),r=globalThis.prisma??new o.PrismaClient}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),o=t.X(0,[1638,6206],()=>a(31796));module.exports=o})();