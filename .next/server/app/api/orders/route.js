"use strict";(()=>{var e={};e.id=9146,e.ids=[9146],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},31796:(e,t,o)=>{o.r(t),o.d(t,{headerHooks:()=>b,originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>p,routeModule:()=>l,serverHooks:()=>P,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>v});var a={};o.r(a),o.d(a,{GET:()=>u,POST:()=>c});var r=o(95419),i=o(69108),n=o(99678),d=o(19631),s=o(78070);async function u(){try{let e=(await d._.pedido.findMany({include:{cliente:!0,itens:{include:{produto:!0}}},orderBy:{data:"desc"}})).map(e=>({id:e.id,clienteId:e.clienteId,nomeCliente:e.cliente.nomeFantasia,data:e.data.toISOString(),status:e.status,valorTotal:Number(e.valorTotal),tabelaPreco:e.tabelaPreco,condicaoPagamento:e.condicaoPagamento,observacoes:e.observacoes,itens:e.itens.map(e=>({id:e.id,produtoId:e.produtoId,nomeProduto:e.produto.nome,quantidade:e.quantidade,precoUnitario:Number(e.precoUnitario),total:Number(e.total)}))}));return s.Z.json(e)}catch(e){return console.error("Error fetching orders:",e),s.Z.json({error:"Failed to fetch orders"},{status:500})}}async function c(e){try{let t=await e.json(),o=t.itens.reduce((e,t)=>e+t.quantidade*t.precoUnitario,0),a=await d._.pedido.create({data:{clienteId:t.clienteId,status:"Pendente",valorTotal:o,tabelaPreco:t.tabelaPreco,condicaoPagamento:t.condicaoPagamento,observacoes:t.observacoes,itens:{create:t.itens.map(e=>({produtoId:e.produtoId,quantidade:e.quantidade,precoUnitario:e.precoUnitario,total:e.quantidade*e.precoUnitario}))}},include:{cliente:!0,itens:{include:{produto:!0}}}});return s.Z.json({id:a.id,clienteId:a.clienteId,nomeCliente:a.cliente.nomeFantasia,data:a.data.toISOString(),status:a.status,valorTotal:Number(a.valorTotal),itens:a.itens.map(e=>({id:e.id,produtoId:e.produtoId,nomeProduto:e.produto.nome,quantidade:e.quantidade,precoUnitario:Number(e.precoUnitario),total:Number(e.total)}))},{status:201})}catch(e){return console.error("Error creating order:",e),s.Z.json({error:"Failed to create order"},{status:500})}}let l=new r.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/orders/route",pathname:"/api/orders",filename:"route",bundlePath:"app/api/orders/route"},resolvedPagePath:"E:\\FRPlus\\frplus-web\\src\\app\\api\\orders\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:p,staticGenerationAsyncStorage:m,serverHooks:P,headerHooks:b,staticGenerationBailout:v}=l,g="/api/orders/route";function h(){return(0,n.patchFetch)({serverHooks:P,staticGenerationAsyncStorage:m})}},19631:(e,t,o)=>{o.d(t,{_:()=>r});let a=require("@prisma/client"),r=globalThis.prisma??new a.PrismaClient}};var t=require("../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),a=t.X(0,[1638,6206],()=>o(31796));module.exports=a})();