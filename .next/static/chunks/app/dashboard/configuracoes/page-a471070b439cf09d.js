(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[761],{98515:function(e,r,s){Promise.resolve().then(s.bind(s,61447))},61447:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return b}});var t=s(3827),a=s(29910),o=s(70699),c=s(10632),i=s(40834),l=s(46578),d=s(98998),n=s(81049),u=s(50489),m=s(5590),x=s(47907),h=s(64090),p=s(38371);function b(){let{logout:e,showToast:r}=(0,m.e)(),s=(0,x.useRouter)(),[b,f]=(0,h.useState)("Minha Empresa"),[g,j]=(0,h.useState)(null),[y,w]=(0,h.useState)(!1),[N,v]=(0,h.useState)(null),E=async()=>{if(!g)return;w(!0),v(null);let e=new FormData;e.append("file",g);try{let s=await fetch("/api/import/csv",{method:"POST",body:e}),t=await s.json();t.success?(v(t.stats),r("Importa\xe7\xe3o conclu\xedda com sucesso!","success"),j(null)):r(t.error||"Erro ao importar","error")}catch(e){console.error(e),r("Erro de conex\xe3o ao importar.","error")}finally{w(!1)}},k=async()=>{if(confirm("ATEN\xc7\xc3O: Isso apagar\xe1 TODOS os dados do BANCO DE DADOS (clientes, produtos, pedidos). Apenas seus usu\xe1rios ser\xe3o mantidos. Tem certeza absoluta?"))try{let e=await fetch("/api/admin/reset-data",{method:"POST"}),s=await e.json();s.success?(r("Sistema limpo com sucesso!","success"),setTimeout(()=>window.location.reload(),1500)):r("Erro ao limpar: "+s.details,"error")}catch(e){console.error(e),r("Erro de conex\xe3o ao resetar.","error")}};return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,t.jsx)("div",{className:"p-3 rounded-xl bg-blue-600/20 text-blue-500",children:(0,t.jsx)(a.Z,{className:"h-8 w-8"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Configura\xe7\xf5es"}),(0,t.jsx)("p",{className:"text-gray-400",children:"Gerencie sua conta e as prefer\xeancias do sistema."})]})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-6 backdrop-blur-sm",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-white mb-6",children:"Informa\xe7\xf5es da Conta"}),(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-300",children:"Nome da Empresa"}),(0,t.jsx)("input",{value:b,onChange:e=>f(e.target.value),className:"w-full rounded-lg bg-black/20 border border-white/10 p-2.5 text-white focus:border-blue-500 focus:outline-none"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-300",children:"Email de Acesso"}),(0,t.jsx)("input",{disabled:!0,value:"admin@frplus.com",className:"w-full rounded-lg bg-black/40 border border-white/10 p-2.5 text-gray-500 cursor-not-allowed"})]})]}),(0,t.jsx)("div",{className:"mt-6 flex justify-end",children:(0,t.jsxs)("button",{onClick:()=>{r("Configura\xe7\xf5es salvas!","success")},className:"flex items-center rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-500 transition-colors",children:[(0,t.jsx)(o.Z,{className:"mr-2 h-4 w-4"}),"Salvar Perfil"]})})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-6 backdrop-blur-sm",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Importa\xe7\xe3o de Dados"}),(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"Importe dados do Protheus via CSV (Clientes, Produtos e Hist\xf3rico)."})]}),(0,t.jsx)("div",{className:"p-2 rounded-lg bg-emerald-500/10 text-emerald-500",children:(0,t.jsx)(c.Z,{className:"h-5 w-5"})})]}),(0,t.jsxs)("div",{className:"bg-black/20 rounded-lg p-4 border border-white/5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("input",{type:"file",accept:".csv",onChange:e=>{var r;return j((null===(r=e.target.files)||void 0===r?void 0:r[0])||null)},className:"block w-full text-sm text-gray-400   file:mr-4 file:py-2 file:px-4   file:rounded-lg file:border-0   file:text-sm file:font-semibold   file:bg-blue-600 file:text-white   hover:file:bg-blue-500   cursor-pointer"}),(0,t.jsxs)("button",{onClick:E,disabled:!g||y,className:"shrink-0 flex items-center rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white hover:bg-emerald-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[y?(0,t.jsx)(i.Z,{className:"mr-2 h-4 w-4 animate-spin"}):(0,t.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),y?"Importando...":"Iniciar Importa\xe7\xe3o"]})]}),N&&(0,t.jsxs)(p.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-6 border-t border-white/10 pt-4",children:[(0,t.jsxs)("h4",{className:"text-sm font-semibold text-white mb-3 flex items-center gap-2",children:[(0,t.jsx)(l.Z,{className:"h-4 w-4 text-emerald-500"}),"Resultado da Importa\xe7\xe3o"]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"bg-white/5 rounded-lg p-3 text-center",children:[(0,t.jsx)("p",{className:"text-xs text-gray-400 uppercase",children:"Clientes"}),(0,t.jsxs)("p",{className:"text-lg font-bold text-white",children:["+",N.clientsNew," ",(0,t.jsxs)("span",{className:"text-xs text-gray-500 font-normal",children:["(",N.clientsUpdated," atualizados)"]})]})]}),(0,t.jsxs)("div",{className:"bg-white/5 rounded-lg p-3 text-center",children:[(0,t.jsx)("p",{className:"text-xs text-gray-400 uppercase",children:"Produtos"}),(0,t.jsxs)("p",{className:"text-lg font-bold text-white",children:["+",N.productsNew," ",(0,t.jsxs)("span",{className:"text-xs text-gray-500 font-normal",children:["(",N.productsUpdated||0," atl)"]})]})]}),(0,t.jsxs)("div",{className:"bg-white/5 rounded-lg p-3 text-center",children:[(0,t.jsx)("p",{className:"text-xs text-gray-400 uppercase",children:"Pedidos"}),(0,t.jsxs)("p",{className:"text-lg font-bold text-white",children:["+",N.ordersCreated]})]}),(0,t.jsxs)("div",{className:"bg-white/5 rounded-lg p-3 text-center",children:[(0,t.jsx)("p",{className:"text-xs text-gray-400 uppercase",children:"Ignorados"}),(0,t.jsx)("p",{className:"text-lg font-bold text-gray-400",children:N.ordersSkipped})]})]}),N.errors.length>0&&(0,t.jsxs)("div",{className:"mt-4 p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:[(0,t.jsxs)("p",{className:"text-red-400 text-xs font-semibold mb-2 flex items-center gap-2",children:[(0,t.jsx)(d.Z,{className:"h-3 w-3"}),"Erros (",N.errors.length,")"]}),(0,t.jsxs)("div",{className:"max-h-24 overflow-y-auto text-xs text-red-300/80 space-y-1",children:[N.errors.slice(0,5).map((e,r)=>(0,t.jsx)("p",{children:e},r)),N.errors.length>5&&(0,t.jsxs)("p",{children:["...e mais ",N.errors.length-5," erros"]})]})]})]})]})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-red-500/20 bg-red-500/5 p-6 backdrop-blur-sm",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-red-500 mb-6",children:"\xc1rea de Risco"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg bg-black/20 border border-white/5",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-white",children:"Sair do Sistema"}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"Desconectar sua conta deste dispositivo."})]}),(0,t.jsxs)("button",{onClick:()=>{e(),s.push("/")},className:"flex items-center rounded-lg border border-white/10 px-4 py-2 text-sm font-medium text-white hover:bg-white/10 transition-colors",children:[(0,t.jsx)(n.Z,{className:"mr-2 h-4 w-4"}),"Sair"]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg bg-black/20 border border-red-500/20",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-red-400",children:"Resetar Sistema (Manter Usu\xe1rios)"}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"Apaga Clientes, Produtos e Pedidos. Mant\xe9m seu login."})]}),(0,t.jsxs)("button",{onClick:k,className:"flex items-center rounded-lg bg-red-600/10 px-4 py-2 text-sm font-medium text-red-500 hover:bg-red-600/20 transition-colors border border-red-500/20",children:[(0,t.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Resetar Tudo"]})]})]})]})]})}},5590:function(e,r,s){"use strict";s.d(r,{F:function(){return x},e:function(){return h}});var t=s(3827),a=s(64090),o=s(46578),c=s(98998),i=s(28814),l=s(52235),d=s(28745),n=s(38371);function u(e){let{message:r,type:s,isVisible:u=!0,onClose:m}=e;return(0,a.useEffect)(()=>{if(u){let e=setTimeout(()=>{m()},3e3);return()=>clearTimeout(e)}},[u,m]),(0,t.jsx)(d.M,{children:u&&(0,t.jsxs)(n.E.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},className:"fixed bottom-6 right-6 z-50 flex items-center gap-3 rounded-xl border border-white/10 bg-black/80 px-4 py-3 text-sm text-white shadow-2xl backdrop-blur-md",children:[(0,t.jsxs)("div",{className:"rounded-full p-1 ".concat("success"===s?"bg-green-500/20 text-green-500":"error"===s?"bg-red-500/20 text-red-500":"bg-blue-500/20 text-blue-500"),children:["success"===s&&(0,t.jsx)(o.Z,{className:"h-4 w-4"}),"error"===s&&(0,t.jsx)(c.Z,{className:"h-4 w-4"}),"info"===s&&(0,t.jsx)(i.Z,{className:"h-4 w-4"})]}),(0,t.jsx)("span",{className:"font-medium pr-2",children:r}),(0,t.jsx)("button",{onClick:m,className:"ml-2 rounded-lg p-1 text-gray-400 hover:bg-white/10 hover:text-white transition-colors",children:(0,t.jsx)(l.Z,{className:"h-3 w-3"})})]})})}let m=(0,a.createContext)(void 0);function x(e){let{children:r}=e,[s,o]=(0,a.useState)([]),[c,i]=(0,a.useState)([]),[l,d]=(0,a.useState)([]),[n,x]=(0,a.useState)([]),[h,p]=(0,a.useState)(!0),[b,f]=(0,a.useState)(null),[g,j]=(0,a.useState)(null),y=(0,a.useCallback)((e,r)=>{j({message:e,type:r})},[]),w=(0,a.useCallback)(async()=>{p(!0);try{let[e,r,s,t]=await Promise.all([fetch("/api/clients"),fetch("/api/products"),fetch("/api/orders"),fetch("/api/fabricas")]);e.ok&&o(await e.json()),r.ok&&i(await r.json()),s.ok&&d(await s.json()),t.ok&&x(await t.json())}catch(e){console.error("Error fetching data:",e),y("Erro ao carregar dados","error")}finally{p(!1)}},[y]);(0,a.useEffect)(()=>{w();let e=localStorage.getItem("frplus_user");e&&f(e)},[w]);let N=async e=>{try{let r=await fetch("/api/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(r.ok){let e=await r.json();o(r=>[...r,e]),y("Cliente cadastrado com sucesso!","success")}else y("Erro ao cadastrar cliente","error")}catch(e){console.error("Error adding client:",e),y("Erro ao cadastrar cliente","error")}},v=async(e,r)=>{try{let s=await fetch("/api/clients/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(s.ok){let r=await s.json();o(s=>s.map(s=>s.id===e?r:s)),y("Cliente atualizado com sucesso!","success")}}catch(e){console.error("Error updating client:",e),y("Erro ao atualizar cliente","error")}},E=async e=>{try{(await fetch("/api/clients/".concat(e),{method:"DELETE"})).ok&&(o(r=>r.filter(r=>r.id!==e)),y("Cliente exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing client:",e),y("Erro ao excluir cliente","error")}},k=async e=>{try{(await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await w(),y("Produto cadastrado com sucesso!","success")):y("Erro ao cadastrar produto","error")}catch(e){console.error("Error adding product:",e),y("Erro ao cadastrar produto","error")}},S=async(e,r)=>{try{(await fetch("/api/products/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok&&(await w(),y("Produto atualizado com sucesso!","success"))}catch(e){console.error("Error updating product:",e),y("Erro ao atualizar produto","error")}},C=async e=>{try{(await fetch("/api/products/".concat(e),{method:"DELETE"})).ok&&(i(r=>r.filter(r=>r.id!==e)),y("Produto exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing product:",e),y("Erro ao excluir produto","error")}},T=async e=>{try{(await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await w(),y("Pedido cadastrado com sucesso!","success")):y("Erro ao cadastrar pedido","error")}catch(e){console.error("Error adding order:",e),y("Erro ao cadastrar pedido","error")}},P=async(e,r)=>{try{(await fetch("/api/orders/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok&&(await w(),y("Pedido atualizado com sucesso!","success"))}catch(e){console.error("Error updating order:",e),y("Erro ao atualizar pedido","error")}},O=async e=>{try{(await fetch("/api/orders/".concat(e),{method:"DELETE"})).ok&&(d(r=>r.filter(r=>r.id!==e)),y("Pedido exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing order:",e),y("Erro ao excluir pedido","error")}},D=async e=>{try{let r=await fetch("/api/fabricas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(r.ok){let e=await r.json();x(r=>[...r,e]),y("F\xe1brica cadastrada com sucesso!","success")}}catch(e){console.error("Error adding fabrica:",e),y("Erro ao cadastrar f\xe1brica","error")}},I=async(e,r)=>{try{(await fetch("/api/fabricas/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok&&(await w(),y("F\xe1brica atualizada com sucesso!","success"))}catch(e){console.error("Error updating fabrica:",e),y("Erro ao atualizar f\xe1brica","error")}},Z=async e=>{try{(await fetch("/api/fabricas/".concat(e),{method:"DELETE"})).ok&&(x(r=>r.filter(r=>r.id!==e)),y("F\xe1brica exclu\xedda com sucesso!","success"))}catch(e){console.error("Error removing fabrica:",e),y("Erro ao excluir f\xe1brica","error")}};return(0,t.jsxs)(m.Provider,{value:{clients:s,products:c,orders:l,fabricas:n,loading:h,addClient:N,updateClient:v,removeClient:E,addProduct:k,updateProduct:S,removeProduct:C,addOrder:T,updateOrder:P,removeOrder:O,addFabrica:D,updateFabrica:I,removeFabrica:Z,getDashboardStats:()=>({totalSales:l.reduce((e,r)=>e+r.valorTotal,0),totalOrders:l.length,newClients:s.length,totalProducts:c.length}),showToast:y,user:b,login:e=>{f(e),localStorage.setItem("frplus_user",e)},logout:()=>{f(null),localStorage.removeItem("frplus_user")},refreshData:w},children:[r,g&&(0,t.jsx)(u,{message:g.message,type:g.type,onClose:()=>j(null)})]})}function h(){let e=(0,a.useContext)(m);if(void 0===e)throw Error("useData must be used within a DataProvider");return e}}},function(e){e.O(0,[462,491,971,69,744],function(){return e(e.s=98515)}),_N_E=e.O()}]);