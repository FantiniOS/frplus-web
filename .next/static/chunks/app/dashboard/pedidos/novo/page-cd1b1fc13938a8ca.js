(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[811],{92402:function(e,t,r){Promise.resolve().then(r.bind(r,8164))},98998:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},53879:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},46578:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},95132:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]])},28814:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},70699:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},28670:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},82800:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},11213:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},52235:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(87461).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},47907:function(e,t,r){"use strict";var a=r(15313);r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},8164:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var a=r(3827),o=r(53879),s=r(70699),i=r(95132),n=r(11213),l=r(28670),c=r(82800),d=r(5590),u=r(64090),p=r(47907),x=r(28745),h=r(38371);function m(){let{clients:e,products:t,addOrder:r,showToast:m,fabricas:f}=(0,d.e)(),y=(0,p.useRouter)(),[g,b]=(0,u.useState)("factory"),[j,w]=(0,u.useState)(""),[v,N]=(0,u.useState)(""),[k,C]=(0,u.useState)([]),[E,S]=(0,u.useState)(""),[P,Z]=(0,u.useState)(new Date().toISOString().split("T")[0]),[T,z]=(0,u.useState)("preco50a199"),[I,L]=(0,u.useState)("30 dias"),[M,O]=(0,u.useState)(""),[R,q]=(0,u.useState)(""),[D,F]=(0,u.useState)("all"),[U,_]=(0,u.useState)({}),V=f.find(e=>e.id===j),A=e.find(e=>e.id===v),J=async e=>{try{let t=await fetch("/api/clients/".concat(e,"/product-history"));if(t.ok){let e=await t.json();_(e)}}catch(e){console.error("Error fetching price history:",e)}},B=e=>{w(e),b("client"),C([])},H=t=>{N(t);let r=e.find(e=>e.id===t);(null==r?void 0:r.tabelaPreco)&&z(r.tabelaPreco),J(t),b("order")},$=e=>Number(e[T]||e.preco50a199),W=e=>{let t=$(e);C(r=>r.find(t=>t.produtoId===e.id)?r.map(r=>r.produtoId===e.id?{...r,quantidade:r.quantidade+1,total:(r.quantidade+1)*t}:r):[...r,{produtoId:e.id,nomeProduto:e.nome,quantidade:1,precoUnitario:t,total:t}])},X=e=>{C(t=>{let r=t.find(t=>t.produtoId===e);return r&&r.quantidade>1?t.map(t=>t.produtoId===e?{...t,quantidade:t.quantidade-1,total:(t.quantidade-1)*t.precoUnitario}:t):t.filter(t=>t.produtoId!==e)})},G=(e,t)=>{if(!(t<0)){if(0===t){C(t=>t.filter(t=>t.produtoId!==e));return}C(r=>r.map(r=>r.produtoId===e?{...r,quantidade:t,total:t*r.precoUnitario}:r))}},K=(0,u.useMemo)(()=>V?t.filter(e=>{let t=e.fabricaId===V.id,r=e.nome.toLowerCase().includes(M.toLowerCase())||e.codigo.toLowerCase().includes(M.toLowerCase()),a="all"===D||e.categoria===D;return t&&r&&a}):[],[t,V,M,D]),Q=(0,u.useMemo)(()=>{if(!V)return[];let e=t.filter(e=>e.fabricaId===V.id).map(e=>e.categoria).filter(e=>!!e);return Array.from(new Set(e))},[t,V]),Y=(0,u.useMemo)(()=>e.filter(e=>e.nomeFantasia.toLowerCase().includes(R.toLowerCase())||e.razaoSocial.toLowerCase().includes(R.toLowerCase())||e.cnpj.includes(R)),[e,R]),ee=k.reduce((e,t)=>e+t.total,0),et=k.reduce((e,t)=>e+t.quantidade,0),er=async()=>{if(!v||0===k.length){m("Selecione um cliente e adicione itens.","error");return}try{await r({clienteId:v,nomeCliente:(null==A?void 0:A.nomeFantasia)||"Cliente",fabricaId:j,data:new Date(P).toISOString(),status:"Pendente",valorTotal:ee,tabelaPreco:T,condicaoPagamento:I,observacoes:E,itens:k.map(e=>({produtoId:e.produtoId,nomeProduto:e.nomeProduto,quantidade:e.quantidade,precoUnitario:e.precoUnitario,total:e.total}))}),y.push("/dashboard/pedidos")}catch(e){console.error(e),m("Erro ao salvar pedido","error")}};return(0,a.jsxs)("div",{className:"min-h-screen bg-[#121214] text-white flex flex-col",children:[(0,a.jsxs)("header",{className:"h-16 border-b border-white/5 bg-[#121214] flex items-center justify-between px-4 sticky top-0 z-20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("button",{onClick:()=>{"order"===g?b("client"):"client"===g?b("factory"):y.back()},className:"p-2 hover:bg-white/5 rounded-full transition-colors",children:(0,a.jsx)(o.Z,{className:"w-5 h-5 text-gray-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-sm font-bold text-white uppercase tracking-wider",children:"factory"===g?"Nova Venda / Selecionar F\xe1brica":"client"===g?"Nova Venda / Selecionar Cliente":"Pedido: ".concat(null==V?void 0:V.nome)}),"order"===g&&A&&(0,a.jsx)("p",{className:"text-xs text-blue-400 font-medium",children:A.nomeFantasia})]})]}),"order"===g&&(0,a.jsxs)("button",{onClick:er,disabled:0===k.length,className:"flex items-center gap-2 bg-green-600 hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed text-white px-4 py-2 rounded-lg text-sm font-bold transition-all shadow-lg shadow-green-900/20",children:[(0,a.jsx)(s.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Finalizar"})]})]}),(0,a.jsx)("main",{className:"flex-1 overflow-hidden relative",children:(0,a.jsxs)(x.M,{mode:"wait",children:["factory"===g&&(0,a.jsxs)(h.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"p-6 max-w-4xl mx-auto",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[(0,a.jsx)(i.Z,{className:"text-purple-400"}),"Escolha a F\xe1brica"]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(e=>(0,a.jsxs)("button",{onClick:()=>B(e.id),className:"p-6 rounded-xl border border-white/10 bg-white/5 hover:bg-purple-600/20 hover:border-purple-500/50 transition-all group text-left",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-white group-hover:text-purple-400 mb-2",children:e.nome}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[e.produtosCount||0," produtos"]})]},e.id))})]},"factory"),"client"===g&&(0,a.jsxs)(h.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"p-6 max-w-4xl mx-auto h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[(0,a.jsx)(n.Z,{className:"text-blue-400"}),"Selecione o Cliente"]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(l.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Buscar por nome, raz\xe3o social ou CNPJ...",value:R,onChange:e=>q(e.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-xl py-3 pl-10 pr-4 text-white focus:outline-none focus:border-blue-500 transition-colors",autoFocus:!0})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-2 pr-2 custom-scrollbar",children:[Y.map(e=>(0,a.jsxs)("button",{onClick:()=>H(e.id),className:"w-full p-4 rounded-xl border border-white/5 bg-white/5 hover:bg-white/10 text-left transition-colors flex items-center justify-between group",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold text-white group-hover:text-blue-400 transition-colors",children:e.nomeFantasia}),(0,a.jsx)("p",{className:"text-xs text-gray-500 uppercase",children:e.razaoSocial}),(0,a.jsx)("p",{className:"text-xs text-gray-600 font-mono mt-1",children:e.cnpj})]}),(0,a.jsxs)("div",{className:"text-right text-xs text-gray-500",children:[(0,a.jsxs)("p",{children:[e.cidade,"/",e.estado]}),e.ultima_compra&&(0,a.jsxs)("p",{className:"mt-1",children:["\xdaltima compra: ",new Date(e.ultima_compra).toLocaleDateString()]})]})]},e.id)),0===Y.length&&(0,a.jsx)("div",{className:"text-center py-12 text-gray-500",children:"Nenhum cliente encontrado."})]})]},"client"),"order"===g&&(0,a.jsxs)(h.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col h-full lg:flex-row",children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-w-0 bg-[#0d0d0e]",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-white/5 space-y-3",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(l.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),(0,a.jsx)("input",{type:"text",value:M,onChange:e=>O(e.target.value),placeholder:"Buscar produto por c\xf3digo ou nome...",className:"w-full bg-gray-800 border border-gray-700 rounded-lg py-2 pl-9 pr-4 text-sm text-white focus:outline-none focus:border-blue-500"})]}),(0,a.jsxs)("div",{className:"flex gap-2 overflow-x-auto pb-1 custom-scrollbar",children:[(0,a.jsx)("button",{onClick:()=>F("all"),className:"px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap transition-colors ".concat("all"===D?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"),children:"Todos"}),Q.map(e=>(0,a.jsx)("button",{onClick:()=>F(e),className:"px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap transition-colors ".concat(D===e?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"),children:e},e))]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-auto custom-scrollbar",children:(0,a.jsxs)("table",{className:"w-full text-left border-collapse",children:[(0,a.jsx)("thead",{className:"bg-[#121214] sticky top-0 z-10 text-xs font-bold text-gray-500 uppercase tracking-wider",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 border-b border-white/5",children:"Cod"}),(0,a.jsx)("th",{className:"px-4 py-3 border-b border-white/5 w-full",children:"Produto"}),(0,a.jsx)("th",{className:"px-4 py-3 border-b border-white/5 text-center hidden sm:table-cell",children:"Categ."}),(0,a.jsx)("th",{className:"px-4 py-3 border-b border-white/5 text-right w-[100px]",children:"Pre\xe7o"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-white/5",children:K.map(e=>{let t=k.find(t=>t.produtoId===e.id),r=(null==t?void 0:t.quantidade)||0,o=$(e),s=U[e.id];return(0,a.jsxs)("tr",{onClick:()=>W(e),className:"\n                                                            group cursor-pointer transition-colors\n                                                            ".concat(r>0?"bg-blue-900/10 hover:bg-blue-900/20":"hover:bg-white/5","\n                                                        "),children:[(0,a.jsx)("td",{className:"px-4 py-3 text-xs text-gray-500 font-mono border-r border-white/5",children:e.codigo}),(0,a.jsxs)("td",{className:"px-4 py-3 border-r border-white/5",children:[(0,a.jsx)("div",{className:"font-medium text-gray-200 group-hover:text-white transition-colors",children:e.nome}),(0,a.jsx)("div",{className:"flex items-center gap-2 mt-1",children:s&&(0,a.jsxs)("span",{className:"text-[10px] bg-yellow-400/10 text-yellow-400 px-1.5 py-0.5 rounded border border-yellow-400/20",title:"\xdaltimo pre\xe7o pago",children:["\xdalt: ",s.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]})})]}),(0,a.jsx)("td",{className:"px-4 py-3 text-xs text-gray-500 text-center hidden sm:table-cell border-r border-white/5",children:e.categoria||"-"}),(0,a.jsxs)("td",{className:"px-4 py-3 text-right",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-300",children:o.toLocaleString("pt-BR",{minimumFractionDigits:2})}),(0,a.jsx)("div",{className:"flex items-center justify-end gap-1mt-1",onClick:e=>e.stopPropagation(),children:r>0&&(0,a.jsxs)("div",{className:"flex items-center bg-gray-900 rounded-lg border border-gray-700 mt-1",children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),X(e.id)},className:"w-7 h-7 flex items-center justify-center text-gray-400 hover:text-white hover:bg-gray-700 rounded-l-lg",children:"-"}),(0,a.jsx)("input",{type:"number",value:r,onChange:t=>{let r=parseInt(t.target.value);isNaN(r)||G(e.id,r)},onClick:e=>e.stopPropagation(),className:"w-10 h-7 bg-transparent text-center text-sm font-bold text-blue-400 focus:outline-none appearance-none"}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),W(e)},className:"w-7 h-7 flex items-center justify-center text-gray-400 hover:text-white hover:bg-gray-700 rounded-r-lg",children:"+"})]})})]})]},e.id)})})]})})]}),(0,a.jsxs)("div",{className:"w-full lg:w-[350px] bg-[#121214] border-t lg:border-t-0 lg:border-l border-white/10 flex flex-col z-20 shadow-2xl",children:[(0,a.jsx)("div",{className:"p-4 space-y-4 border-b border-white/5 bg-gray-900/50",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsx)("label",{className:"text-[10px] uppercase font-bold text-gray-500",children:"Tabela de Pre\xe7o"}),(0,a.jsxs)("select",{value:T,onChange:e=>z(e.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg text-xs px-3 py-2 text-white focus:border-blue-500 outline-none",children:[(0,a.jsx)("option",{value:"preco50a199",children:"Padr\xe3o"}),(0,a.jsx)("option",{value:"preco200a699",children:"200 a 699"}),(0,a.jsx)("option",{value:"atacado",children:"Atacado"}),(0,a.jsx)("option",{value:"atacadoAVista",children:"Atacado \xe0 Vista"}),(0,a.jsx)("option",{value:"redes",children:"Redes"})]})]}),(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsx)("label",{className:"text-[10px] uppercase font-bold text-gray-500",children:"Condi\xe7\xe3o Pagto"}),(0,a.jsxs)("select",{value:I,onChange:e=>L(e.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg text-xs px-3 py-2 text-white focus:border-blue-500 outline-none",children:[(0,a.jsx)("option",{children:"A Vista"}),(0,a.jsx)("option",{children:"30 Dias"}),(0,a.jsx)("option",{children:"30/60 Dias"}),(0,a.jsx)("option",{children:"30/60/90 Dias"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-[10px] uppercase font-bold text-gray-500",children:"Data Emiss\xe3o"}),(0,a.jsx)("input",{type:"date",value:P,onChange:e=>Z(e.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg text-xs px-3 py-2 text-white focus:border-blue-500 outline-none"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"text-[10px] uppercase font-bold text-gray-500",children:"Observa\xe7\xf5es"}),(0,a.jsx)("textarea",{rows:2,value:E,onChange:e=>S(e.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg text-xs px-3 py-2 text-white resize-none focus:border-blue-500 outline-none",placeholder:"Obs. do pedido..."})]})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 bg-[#0f0f10]",children:0===k.length?(0,a.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-600 space-y-2",children:[(0,a.jsx)(c.Z,{className:"w-8 h-8 opacity-20"}),(0,a.jsx)("p",{className:"text-xs",children:"Carrinho vazio"})]}):k.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-2 rounded bg-white/5 border border-white/5 text-xs",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0 pr-2",children:[(0,a.jsx)("p",{className:"font-medium text-gray-300 truncate",children:e.nomeProduto}),(0,a.jsxs)("p",{className:"text-gray-500",children:[e.quantidade," x R$ ",e.precoUnitario.toFixed(2)]})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("p",{className:"font-bold text-white",children:["R$ ",e.total.toFixed(2)]})})]},t))}),(0,a.jsxs)("div",{className:"p-4 bg-gray-900 border-t border-white/10",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("span",{className:"text-xs text-gray-400",children:"Itens"}),(0,a.jsx)("span",{className:"text-sm font-mono text-white",children:et})]}),(0,a.jsxs)("div",{className:"flex justify-between items-end",children:[(0,a.jsx)("span",{className:"text-sm font-bold text-gray-400",children:"TOTAL"}),(0,a.jsx)("span",{className:"text-2xl font-bold text-green-400",children:ee.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]})]})]})]},"order")]})})]})}},5590:function(e,t,r){"use strict";r.d(t,{F:function(){return x},e:function(){return h}});var a=r(3827),o=r(64090),s=r(46578),i=r(98998),n=r(28814),l=r(52235),c=r(28745),d=r(38371);function u(e){let{message:t,type:r,isVisible:u=!0,onClose:p}=e;return(0,o.useEffect)(()=>{if(u){let e=setTimeout(()=>{p()},3e3);return()=>clearTimeout(e)}},[u,p]),(0,a.jsx)(c.M,{children:u&&(0,a.jsxs)(d.E.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},className:"fixed bottom-6 right-6 z-50 flex items-center gap-3 rounded-xl border border-white/10 bg-black/80 px-4 py-3 text-sm text-white shadow-2xl backdrop-blur-md",children:[(0,a.jsxs)("div",{className:"rounded-full p-1 ".concat("success"===r?"bg-green-500/20 text-green-500":"error"===r?"bg-red-500/20 text-red-500":"bg-blue-500/20 text-blue-500"),children:["success"===r&&(0,a.jsx)(s.Z,{className:"h-4 w-4"}),"error"===r&&(0,a.jsx)(i.Z,{className:"h-4 w-4"}),"info"===r&&(0,a.jsx)(n.Z,{className:"h-4 w-4"})]}),(0,a.jsx)("span",{className:"font-medium pr-2",children:t}),(0,a.jsx)("button",{onClick:p,className:"ml-2 rounded-lg p-1 text-gray-400 hover:bg-white/10 hover:text-white transition-colors",children:(0,a.jsx)(l.Z,{className:"h-3 w-3"})})]})})}let p=(0,o.createContext)(void 0);function x(e){let{children:t}=e,[r,s]=(0,o.useState)([]),[i,n]=(0,o.useState)([]),[l,c]=(0,o.useState)([]),[d,x]=(0,o.useState)([]),[h,m]=(0,o.useState)(!0),[f,y]=(0,o.useState)(null),[g,b]=(0,o.useState)(null),j=(0,o.useCallback)((e,t)=>{b({message:e,type:t})},[]),w=(0,o.useCallback)(async()=>{m(!0);try{let[e,t,r,a]=await Promise.all([fetch("/api/clients"),fetch("/api/products"),fetch("/api/orders"),fetch("/api/fabricas")]);e.ok&&s(await e.json()),t.ok&&n(await t.json()),r.ok&&c(await r.json()),a.ok&&x(await a.json())}catch(e){console.error("Error fetching data:",e),j("Erro ao carregar dados","error")}finally{m(!1)}},[j]);(0,o.useEffect)(()=>{w();let e=localStorage.getItem("frplus_user");e&&y(e)},[w]);let v=async e=>{try{let t=await fetch("/api/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){let e=await t.json();s(t=>[...t,e]),j("Cliente cadastrado com sucesso!","success")}else j("Erro ao cadastrar cliente","error")}catch(e){console.error("Error adding client:",e),j("Erro ao cadastrar cliente","error")}},N=async(e,t)=>{try{let r=await fetch("/api/clients/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(r.ok){let t=await r.json();s(r=>r.map(r=>r.id===e?t:r)),j("Cliente atualizado com sucesso!","success")}}catch(e){console.error("Error updating client:",e),j("Erro ao atualizar cliente","error")}},k=async e=>{try{(await fetch("/api/clients/".concat(e),{method:"DELETE"})).ok&&(s(t=>t.filter(t=>t.id!==e)),j("Cliente exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing client:",e),j("Erro ao excluir cliente","error")}},C=async e=>{try{(await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await w(),j("Produto cadastrado com sucesso!","success")):j("Erro ao cadastrar produto","error")}catch(e){console.error("Error adding product:",e),j("Erro ao cadastrar produto","error")}},E=async(e,t)=>{try{(await fetch("/api/products/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok&&(await w(),j("Produto atualizado com sucesso!","success"))}catch(e){console.error("Error updating product:",e),j("Erro ao atualizar produto","error")}},S=async e=>{try{(await fetch("/api/products/".concat(e),{method:"DELETE"})).ok&&(n(t=>t.filter(t=>t.id!==e)),j("Produto exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing product:",e),j("Erro ao excluir produto","error")}},P=async e=>{try{(await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await w(),j("Pedido cadastrado com sucesso!","success")):j("Erro ao cadastrar pedido","error")}catch(e){console.error("Error adding order:",e),j("Erro ao cadastrar pedido","error")}},Z=async(e,t)=>{try{(await fetch("/api/orders/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok&&(await w(),j("Pedido atualizado com sucesso!","success"))}catch(e){console.error("Error updating order:",e),j("Erro ao atualizar pedido","error")}},T=async e=>{try{(await fetch("/api/orders/".concat(e),{method:"DELETE"})).ok&&(c(t=>t.filter(t=>t.id!==e)),j("Pedido exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing order:",e),j("Erro ao excluir pedido","error")}},z=async e=>{try{let t=await fetch("/api/fabricas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){let e=await t.json();x(t=>[...t,e]),j("F\xe1brica cadastrada com sucesso!","success")}}catch(e){console.error("Error adding fabrica:",e),j("Erro ao cadastrar f\xe1brica","error")}},I=async(e,t)=>{try{(await fetch("/api/fabricas/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok&&(await w(),j("F\xe1brica atualizada com sucesso!","success"))}catch(e){console.error("Error updating fabrica:",e),j("Erro ao atualizar f\xe1brica","error")}},L=async e=>{try{(await fetch("/api/fabricas/".concat(e),{method:"DELETE"})).ok&&(x(t=>t.filter(t=>t.id!==e)),j("F\xe1brica exclu\xedda com sucesso!","success"))}catch(e){console.error("Error removing fabrica:",e),j("Erro ao excluir f\xe1brica","error")}};return(0,a.jsxs)(p.Provider,{value:{clients:r,products:i,orders:l,fabricas:d,loading:h,addClient:v,updateClient:N,removeClient:k,addProduct:C,updateProduct:E,removeProduct:S,addOrder:P,updateOrder:Z,removeOrder:T,addFabrica:z,updateFabrica:I,removeFabrica:L,getDashboardStats:()=>({totalSales:l.reduce((e,t)=>e+t.valorTotal,0),totalOrders:l.length,newClients:r.length,totalProducts:i.length}),showToast:j,user:f,login:e=>{y(e),localStorage.setItem("frplus_user",e)},logout:()=>{y(null),localStorage.removeItem("frplus_user")},refreshData:w},children:[t,g&&(0,a.jsx)(u,{message:g.message,type:g.type,onClose:()=>b(null)})]})}function h(){let e=(0,o.useContext)(p);if(void 0===e)throw Error("useData must be used within a DataProvider");return e}},28745:function(e,t,r){"use strict";r.d(t,{M:function(){return y}});var a=r(3827),o=r(64090),s=r(53856),i=r(72435),n=r(24561),l=r(93449);class c extends o.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function d(e){let{children:t,isPresent:r}=e,s=(0,o.useId)(),i=(0,o.useRef)(null),n=(0,o.useRef)({width:0,height:0,top:0,left:0}),{nonce:d}=(0,o.useContext)(l._);return(0,o.useInsertionEffect)(()=>{let{width:e,height:t,top:a,left:o}=n.current;if(r||!i.current||!e||!t)return;i.current.dataset.motionPopId=s;let l=document.createElement("style");return d&&(l.nonce=d),document.head.appendChild(l),l.sheet&&l.sheet.insertRule('\n          [data-motion-pop-id="'.concat(s,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            top: ").concat(a,"px !important;\n            left: ").concat(o,"px !important;\n          }\n        ")),()=>{document.head.removeChild(l)}},[r]),(0,a.jsx)(c,{isPresent:r,childRef:i,sizeRef:n,children:o.cloneElement(t,{ref:i})})}let u=e=>{let{children:t,initial:r,isPresent:s,onExitComplete:l,custom:c,presenceAffectsLayout:u,mode:x}=e,h=(0,i.h)(p),m=(0,o.useId)(),f=(0,o.useCallback)(e=>{for(let t of(h.set(e,!0),h.values()))if(!t)return;l&&l()},[h,l]),y=(0,o.useMemo)(()=>({id:m,initial:r,isPresent:s,custom:c,onExitComplete:f,register:e=>(h.set(e,!1),()=>h.delete(e))}),u?[Math.random(),f]:[s,f]);return(0,o.useMemo)(()=>{h.forEach((e,t)=>h.set(t,!1))},[s]),o.useEffect(()=>{s||h.size||!l||l()},[s]),"popLayout"===x&&(t=(0,a.jsx)(d,{isPresent:s,children:t})),(0,a.jsx)(n.O.Provider,{value:y,children:t})};function p(){return new Map}var x=r(53177);let h=e=>e.key||"";function m(e){let t=[];return o.Children.forEach(e,e=>{(0,o.isValidElement)(e)&&t.push(e)}),t}var f=r(45526);let y=e=>{let{children:t,custom:r,initial:n=!0,onExitComplete:l,presenceAffectsLayout:c=!0,mode:d="sync",propagate:p=!1}=e,[y,g]=(0,x.oO)(p),b=(0,o.useMemo)(()=>m(t),[t]),j=p&&!y?[]:b.map(h),w=(0,o.useRef)(!0),v=(0,o.useRef)(b),N=(0,i.h)(()=>new Map),[k,C]=(0,o.useState)(b),[E,S]=(0,o.useState)(b);(0,f.L)(()=>{w.current=!1,v.current=b;for(let e=0;e<E.length;e++){let t=h(E[e]);j.includes(t)?N.delete(t):!0!==N.get(t)&&N.set(t,!1)}},[E,j.length,j.join("-")]);let P=[];if(b!==k){let e=[...b];for(let t=0;t<E.length;t++){let r=E[t],a=h(r);j.includes(a)||(e.splice(t,0,r),P.push(r))}"wait"===d&&P.length&&(e=P),S(m(e)),C(b);return}let{forceRender:Z}=(0,o.useContext)(s.p);return(0,a.jsx)(a.Fragment,{children:E.map(e=>{let t=h(e),o=(!p||!!y)&&(b===E||j.includes(t));return(0,a.jsx)(u,{isPresent:o,initial:(!w.current||!!n)&&void 0,custom:o?void 0:r,presenceAffectsLayout:c,mode:d,onExitComplete:o?void 0:()=>{if(!N.has(t))return;N.set(t,!0);let e=!0;N.forEach(t=>{t||(e=!1)}),e&&(null==Z||Z(),S(v.current),p&&(null==g||g()),l&&l())},children:e},t)})})}}},function(e){e.O(0,[462,971,69,744],function(){return e(e.s=92402)}),_N_E=e.O()}]);