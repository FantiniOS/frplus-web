(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[643],{51059:function(e,t,a){Promise.resolve().then(a.bind(a,59384))},59384:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return j}});var s=a(3827),r=a(70094),o=a(69475),i=a(48219),c=a(28670),l=a(85159),d=a(23441),n=a(97307),x=a(77731),m=a(50489),h=a(4697),u=a(5590),p=a(8792),g=a(64090),f=a(38371);function j(){let{orders:e,removeOrder:t}=(0,u.e)(),[a,j]=(0,g.useState)(""),[y,w]=(0,g.useState)(null),[b,N]=(0,g.useState)(null),v=e.filter(e=>e.nomeCliente.toLowerCase().includes(a.toLowerCase())||e.id.includes(a)),E={total:e.length,valorTotal:e.reduce((e,t)=>e+t.valorTotal,0)};return(0,s.jsxs)("div",{className:"space-y-5",children:[(0,s.jsxs)("div",{className:"flex flex-col justify-between gap-4 md:flex-row md:items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Pedidos de Venda"}),(0,s.jsxs)("p",{className:"text-sm text-gray-400",children:[e.length," pedidos no sistema"]})]}),(0,s.jsx)(p.default,{href:"/dashboard/pedidos/novo",children:(0,s.jsxs)("button",{className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 font-medium text-white hover:bg-blue-500 transition-all shadow-lg shadow-blue-600/20",children:[(0,s.jsx)(r.Z,{className:"h-4 w-4"}),"Novo Pedido"]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"form-card flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-blue-500/10",children:(0,s.jsx)(o.Z,{className:"h-4 w-4 text-blue-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-400",children:"Total de Pedidos"}),(0,s.jsx)("p",{className:"text-lg font-bold text-white",children:E.total})]})]}),(0,s.jsxs)("div",{className:"form-card flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-green-500/10",children:(0,s.jsx)(i.Z,{className:"h-4 w-4 text-green-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-400",children:"Faturamento Total"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-white",children:["R$ ",E.valorTotal.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(c.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Buscar pedido ou cliente...",value:a,onChange:e=>j(e.target.value),className:"input-compact pl-10 w-full"})]}),(0,s.jsx)("div",{className:"space-y-2",children:0===v.length?(0,s.jsx)("div",{className:"form-card text-center py-8 text-gray-500",children:"Nenhum pedido encontrado."}):v.map((e,t)=>(0,s.jsxs)(f.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.03*t},className:"form-card flex flex-col gap-0 p-0 overflow-hidden",children:[(0,s.jsxs)("div",{onClick:()=>N(b===e.id?null:e.id),className:"p-3 flex flex-col md:flex-row md:items-center justify-between hover:bg-white/5 transition-colors group gap-3 md:gap-0 cursor-pointer",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center gap-1 md:gap-4 w-full min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between md:justify-start gap-2 w-full md:w-auto",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("div",{className:"p-1 rounded bg-blue-500/10 shrink-0",children:b===e.id?(0,s.jsx)(l.Z,{className:"h-3 w-3 text-blue-400"}):(0,s.jsx)(d.Z,{className:"h-3 w-3 text-blue-400"})})}),(0,s.jsxs)("div",{className:"md:hidden flex items-center gap-1",children:[(0,s.jsx)(n.Z,{className:"h-3 w-3 text-gray-500"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 leading-none",children:new Date(e.data).toLocaleDateString("pt-BR")})]})]}),(0,s.jsxs)("div",{className:"w-full md:w-48 min-w-0 pl-1 md:pl-0 mt-1 md:mt-0",children:[(0,s.jsx)("p",{className:"md:hidden text-[10px] text-gray-500 uppercase tracking-wider mb-0.5",children:"Cliente"}),(0,s.jsx)("p",{className:"text-sm font-medium text-white break-words leading-tight w-full",children:e.nomeCliente})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 w-full md:w-auto mt-1 md:mt-0",children:[(0,s.jsx)("div",{className:"hidden md:block md:w-24",children:(0,s.jsxs)("p",{className:"text-xs text-gray-400 flex items-center gap-1 leading-none",children:[(0,s.jsx)(n.Z,{className:"h-3 w-3"}),new Date(e.data).toLocaleDateString("pt-BR")]})}),(0,s.jsxs)("div",{className:"w-full md:w-16 flex justify-between md:block",children:[(0,s.jsx)("span",{className:"md:hidden text-xs text-gray-500",children:"Itens:"}),(0,s.jsxs)("p",{className:"text-xs text-gray-400 leading-none",children:[e.itens.length," ",(0,s.jsx)("span",{className:"hidden md:inline",children:"itens"})]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between w-full md:w-auto gap-4 border-t border-white/5 pt-2 md:pt-0 md:border-0 mt-1 md:mt-0",children:[(0,s.jsxs)("div",{className:"text-left md:text-right md:w-28 flex items-center gap-2 md:block",children:[(0,s.jsx)("span",{className:"md:hidden text-xs text-gray-500 font-medium",children:"Total:"}),(0,s.jsxs)("p",{className:"text-sm font-bold text-green-400 leading-none",children:["R$ ",e.valorTotal.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(p.default,{href:"/dashboard/pedidos/".concat(e.id),onClick:e=>e.stopPropagation(),children:(0,s.jsx)("button",{className:"p-2 rounded-lg text-gray-400 hover:bg-white/10 hover:text-white",children:(0,s.jsx)(x.Z,{className:"h-4 w-4"})})}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),w(e.id)},className:"p-2 rounded-lg text-gray-400 hover:bg-red-500/10 hover:text-red-400",children:(0,s.jsx)(m.Z,{className:"h-4 w-4"})})]})]})]}),b===e.id&&(0,s.jsx)("div",{className:"bg-black/20 border-t border-white/5 p-4 animate-in slide-in-from-top-2 duration-200",children:(0,s.jsxs)("div",{className:"bg-gray-900/50 rounded-lg p-4 border border-white/5",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("h4",{className:"text-sm font-semibold text-gray-300 flex items-center gap-2",children:[(0,s.jsx)(h.Z,{className:"h-4 w-4 text-blue-400"}),"Itens do Pedido"]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:"Pedido"}),(0,s.jsxs)("p",{className:"font-mono text-xs text-gray-400",children:[new Date(e.data).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit"}).replace(/\//g,""),"-",new Date(e.data).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}).replace(":","")]})]})]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-white/10 text-gray-500 text-xs uppercase",children:[(0,s.jsx)("th",{className:"py-2 px-2",children:"Produto"}),(0,s.jsx)("th",{className:"py-2 px-2 text-center",children:"Qtd"}),(0,s.jsx)("th",{className:"py-2 px-2 text-right",children:"Unit\xe1rio"}),(0,s.jsx)("th",{className:"py-2 px-2 text-right",children:"Total"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-white/5",children:e.itens.map((e,t)=>(0,s.jsxs)("tr",{className:"text-gray-300",children:[(0,s.jsx)("td",{className:"py-2 px-2",children:e.nomeProduto}),(0,s.jsx)("td",{className:"py-2 px-2 text-center",children:e.quantidade}),(0,s.jsxs)("td",{className:"py-2 px-2 text-right",children:["R$ ",e.precoUnitario.toFixed(2)]}),(0,s.jsxs)("td",{className:"py-2 px-2 text-right font-medium text-green-400",children:["R$ ",e.total.toFixed(2)]})]},t))})]})})]})})]},e.id))}),y&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"form-card p-6 max-w-sm w-full mx-4 space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Excluir Pedido"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Tem certeza que deseja excluir este pedido? Esta a\xe7\xe3o n\xe3o pode ser desfeita."}),(0,s.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,s.jsx)("button",{onClick:()=>w(null),className:"px-4 py-2 text-sm text-gray-400 hover:text-white",children:"Cancelar"}),(0,s.jsx)("button",{onClick:()=>{y&&(t(y),w(null))},className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-500",children:"Excluir"})]})]})})]})}},5590:function(e,t,a){"use strict";a.d(t,{F:function(){return h},e:function(){return u}});var s=a(3827),r=a(64090),o=a(46578),i=a(98998),c=a(28814),l=a(52235),d=a(28745),n=a(38371);function x(e){let{message:t,type:a,isVisible:x=!0,onClose:m}=e;return(0,r.useEffect)(()=>{if(x){let e=setTimeout(()=>{m()},3e3);return()=>clearTimeout(e)}},[x,m]),(0,s.jsx)(d.M,{children:x&&(0,s.jsxs)(n.E.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},className:"fixed bottom-6 right-6 z-50 flex items-center gap-3 rounded-xl border border-white/10 bg-black/80 px-4 py-3 text-sm text-white shadow-2xl backdrop-blur-md",children:[(0,s.jsxs)("div",{className:"rounded-full p-1 ".concat("success"===a?"bg-green-500/20 text-green-500":"error"===a?"bg-red-500/20 text-red-500":"bg-blue-500/20 text-blue-500"),children:["success"===a&&(0,s.jsx)(o.Z,{className:"h-4 w-4"}),"error"===a&&(0,s.jsx)(i.Z,{className:"h-4 w-4"}),"info"===a&&(0,s.jsx)(c.Z,{className:"h-4 w-4"})]}),(0,s.jsx)("span",{className:"font-medium pr-2",children:t}),(0,s.jsx)("button",{onClick:m,className:"ml-2 rounded-lg p-1 text-gray-400 hover:bg-white/10 hover:text-white transition-colors",children:(0,s.jsx)(l.Z,{className:"h-3 w-3"})})]})})}let m=(0,r.createContext)(void 0);function h(e){let{children:t}=e,[a,o]=(0,r.useState)([]),[i,c]=(0,r.useState)([]),[l,d]=(0,r.useState)([]),[n,h]=(0,r.useState)([]),[u,p]=(0,r.useState)(!0),[g,f]=(0,r.useState)(null),[j,y]=(0,r.useState)(null),w=(0,r.useCallback)((e,t)=>{y({message:e,type:t})},[]),b=(0,r.useCallback)(async()=>{p(!0);try{let[e,t,a,s]=await Promise.all([fetch("/api/clients"),fetch("/api/products"),fetch("/api/orders"),fetch("/api/fabricas")]);e.ok&&o(await e.json()),t.ok&&c(await t.json()),a.ok&&d(await a.json()),s.ok&&h(await s.json())}catch(e){console.error("Error fetching data:",e),w("Erro ao carregar dados","error")}finally{p(!1)}},[w]);(0,r.useEffect)(()=>{b();let e=localStorage.getItem("frplus_user");e&&f(e)},[b]);let N=async e=>{try{let t=await fetch("/api/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){let e=await t.json();o(t=>[...t,e]),w("Cliente cadastrado com sucesso!","success")}else w("Erro ao cadastrar cliente","error")}catch(e){console.error("Error adding client:",e),w("Erro ao cadastrar cliente","error")}},v=async(e,t)=>{try{let a=await fetch("/api/clients/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(a.ok){let t=await a.json();o(a=>a.map(a=>a.id===e?t:a)),w("Cliente atualizado com sucesso!","success")}}catch(e){console.error("Error updating client:",e),w("Erro ao atualizar cliente","error")}},E=async e=>{try{(await fetch("/api/clients/".concat(e),{method:"DELETE"})).ok&&(o(t=>t.filter(t=>t.id!==e)),w("Cliente exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing client:",e),w("Erro ao excluir cliente","error")}},k=async e=>{try{(await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await b(),w("Produto cadastrado com sucesso!","success")):w("Erro ao cadastrar produto","error")}catch(e){console.error("Error adding product:",e),w("Erro ao cadastrar produto","error")}},T=async(e,t)=>{try{(await fetch("/api/products/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok&&(await b(),w("Produto atualizado com sucesso!","success"))}catch(e){console.error("Error updating product:",e),w("Erro ao atualizar produto","error")}},C=async e=>{try{(await fetch("/api/products/".concat(e),{method:"DELETE"})).ok&&(c(t=>t.filter(t=>t.id!==e)),w("Produto exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing product:",e),w("Erro ao excluir produto","error")}},S=async e=>{try{(await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await b(),w("Pedido cadastrado com sucesso!","success")):w("Erro ao cadastrar pedido","error")}catch(e){console.error("Error adding order:",e),w("Erro ao cadastrar pedido","error")}},P=async(e,t)=>{try{(await fetch("/api/orders/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok&&(await b(),w("Pedido atualizado com sucesso!","success"))}catch(e){console.error("Error updating order:",e),w("Erro ao atualizar pedido","error")}},D=async e=>{try{(await fetch("/api/orders/".concat(e),{method:"DELETE"})).ok&&(d(t=>t.filter(t=>t.id!==e)),w("Pedido exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing order:",e),w("Erro ao excluir pedido","error")}},O=async e=>{try{let t=await fetch("/api/fabricas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){let e=await t.json();h(t=>[...t,e]),w("F\xe1brica cadastrada com sucesso!","success")}}catch(e){console.error("Error adding fabrica:",e),w("Erro ao cadastrar f\xe1brica","error")}},Z=async(e,t)=>{try{(await fetch("/api/fabricas/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok&&(await b(),w("F\xe1brica atualizada com sucesso!","success"))}catch(e){console.error("Error updating fabrica:",e),w("Erro ao atualizar f\xe1brica","error")}},z=async e=>{try{(await fetch("/api/fabricas/".concat(e),{method:"DELETE"})).ok&&(h(t=>t.filter(t=>t.id!==e)),w("F\xe1brica exclu\xedda com sucesso!","success"))}catch(e){console.error("Error removing fabrica:",e),w("Erro ao excluir f\xe1brica","error")}};return(0,s.jsxs)(m.Provider,{value:{clients:a,products:i,orders:l,fabricas:n,loading:u,addClient:N,updateClient:v,removeClient:E,addProduct:k,updateProduct:T,removeProduct:C,addOrder:S,updateOrder:P,removeOrder:D,addFabrica:O,updateFabrica:Z,removeFabrica:z,getDashboardStats:()=>({totalSales:l.reduce((e,t)=>e+t.valorTotal,0),totalOrders:l.length,newClients:a.length,totalProducts:i.length}),showToast:w,user:g,login:e=>{f(e),localStorage.setItem("frplus_user",e)},logout:()=>{f(null),localStorage.removeItem("frplus_user")},refreshData:b},children:[t,j&&(0,s.jsx)(x,{message:j.message,type:j.type,onClose:()=>y(null)})]})}function u(){let e=(0,r.useContext)(m);if(void 0===e)throw Error("useData must be used within a DataProvider");return e}}},function(e){e.O(0,[462,792,338,971,69,744],function(){return e(e.s=51059)}),_N_E=e.O()}]);