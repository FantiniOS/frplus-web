(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[643],{51059:function(e,t,a){Promise.resolve().then(a.bind(a,59384))},59384:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var s=a(3827),r=a(70094),o=a(69475),c=a(48219),i=a(28670),l=a(82800),n=a(97307),d=a(77731),u=a(50489),x=a(5590),h=a(8792),m=a(64090),p=a(38371);function f(){let{orders:e,removeOrder:t}=(0,x.e)(),[a,f]=(0,m.useState)(""),[g,y]=(0,m.useState)(null),j=e.filter(e=>e.nomeCliente.toLowerCase().includes(a.toLowerCase())||e.id.includes(a)),b={total:e.length,valorTotal:e.reduce((e,t)=>e+t.valorTotal,0)};return(0,s.jsxs)("div",{className:"space-y-5",children:[(0,s.jsxs)("div",{className:"flex flex-col justify-between gap-4 md:flex-row md:items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Pedidos de Venda"}),(0,s.jsxs)("p",{className:"text-sm text-gray-400",children:[e.length," pedidos no sistema"]})]}),(0,s.jsx)(h.default,{href:"/dashboard/pedidos/novo",children:(0,s.jsxs)("button",{className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 font-medium text-white hover:bg-blue-500 transition-all shadow-lg shadow-blue-600/20",children:[(0,s.jsx)(r.Z,{className:"h-4 w-4"}),"Novo Pedido"]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"form-card flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-blue-500/10",children:(0,s.jsx)(o.Z,{className:"h-4 w-4 text-blue-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-400",children:"Total de Pedidos"}),(0,s.jsx)("p",{className:"text-lg font-bold text-white",children:b.total})]})]}),(0,s.jsxs)("div",{className:"form-card flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-green-500/10",children:(0,s.jsx)(c.Z,{className:"h-4 w-4 text-green-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-400",children:"Faturamento Total"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-white",children:["R$ ",b.valorTotal.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(i.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Buscar pedido ou cliente...",value:a,onChange:e=>f(e.target.value),className:"input-compact pl-10 w-full"})]}),(0,s.jsx)("div",{className:"space-y-2",children:0===j.length?(0,s.jsx)("div",{className:"form-card text-center py-8 text-gray-500",children:"Nenhum pedido encontrado."}):j.map((e,t)=>(0,s.jsxs)(p.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.03*t},className:"form-card flex items-center justify-between hover:bg-white/5 transition-colors group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-blue-500/10",children:(0,s.jsx)(l.Z,{className:"h-4 w-4 text-blue-400"})}),(0,s.jsxs)("div",{className:"w-20",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Pedido"}),(0,s.jsxs)("p",{className:"font-mono text-sm font-bold text-white",children:["#",e.id.slice(-6)]})]}),(0,s.jsxs)("div",{className:"w-48",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Cliente"}),(0,s.jsx)("p",{className:"text-sm font-medium text-white truncate",children:e.nomeCliente})]}),(0,s.jsxs)("div",{className:"w-28",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Data"}),(0,s.jsxs)("p",{className:"text-sm text-gray-300 flex items-center gap-1",children:[(0,s.jsx)(n.Z,{className:"h-3 w-3"}),new Date(e.data).toLocaleDateString("pt-BR")]})]}),(0,s.jsxs)("div",{className:"w-16",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Itens"}),(0,s.jsx)("p",{className:"text-sm text-gray-300",children:e.itens.length})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"text-right w-28",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Valor"}),(0,s.jsxs)("p",{className:"text-sm font-bold text-green-400",children:["R$ ",e.valorTotal.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,s.jsx)(h.default,{href:"/dashboard/pedidos/".concat(e.id),children:(0,s.jsx)("button",{className:"p-2 rounded-lg text-gray-400 hover:bg-white/10 hover:text-white",children:(0,s.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,s.jsx)("button",{onClick:()=>y(e.id),className:"p-2 rounded-lg text-gray-400 hover:bg-red-500/10 hover:text-red-400",children:(0,s.jsx)(u.Z,{className:"h-4 w-4"})})]})]})]},e.id))}),g&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:(0,s.jsxs)("div",{className:"form-card p-6 max-w-sm w-full mx-4 space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Excluir Pedido"}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Tem certeza que deseja excluir este pedido? Esta a\xe7\xe3o n\xe3o pode ser desfeita."}),(0,s.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,s.jsx)("button",{onClick:()=>y(null),className:"px-4 py-2 text-sm text-gray-400 hover:text-white",children:"Cancelar"}),(0,s.jsx)("button",{onClick:()=>{g&&(t(g),y(null))},className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-500",children:"Excluir"})]})]})})]})}},5590:function(e,t,a){"use strict";a.d(t,{F:function(){return h},e:function(){return m}});var s=a(3827),r=a(64090),o=a(46578),c=a(98998),i=a(28814),l=a(52235),n=a(28745),d=a(38371);function u(e){let{message:t,type:a,isVisible:u=!0,onClose:x}=e;return(0,r.useEffect)(()=>{if(u){let e=setTimeout(()=>{x()},3e3);return()=>clearTimeout(e)}},[u,x]),(0,s.jsx)(n.M,{children:u&&(0,s.jsxs)(d.E.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},className:"fixed bottom-6 right-6 z-50 flex items-center gap-3 rounded-xl border border-white/10 bg-black/80 px-4 py-3 text-sm text-white shadow-2xl backdrop-blur-md",children:[(0,s.jsxs)("div",{className:"rounded-full p-1 ".concat("success"===a?"bg-green-500/20 text-green-500":"error"===a?"bg-red-500/20 text-red-500":"bg-blue-500/20 text-blue-500"),children:["success"===a&&(0,s.jsx)(o.Z,{className:"h-4 w-4"}),"error"===a&&(0,s.jsx)(c.Z,{className:"h-4 w-4"}),"info"===a&&(0,s.jsx)(i.Z,{className:"h-4 w-4"})]}),(0,s.jsx)("span",{className:"font-medium pr-2",children:t}),(0,s.jsx)("button",{onClick:x,className:"ml-2 rounded-lg p-1 text-gray-400 hover:bg-white/10 hover:text-white transition-colors",children:(0,s.jsx)(l.Z,{className:"h-3 w-3"})})]})})}let x=(0,r.createContext)(void 0);function h(e){let{children:t}=e,[a,o]=(0,r.useState)([]),[c,i]=(0,r.useState)([]),[l,n]=(0,r.useState)([]),[d,h]=(0,r.useState)([]),[m,p]=(0,r.useState)(!0),[f,g]=(0,r.useState)(null),[y,j]=(0,r.useState)(null),b=(0,r.useCallback)((e,t)=>{j({message:e,type:t})},[]),N=(0,r.useCallback)(async()=>{p(!0);try{let[e,t,a,s]=await Promise.all([fetch("/api/clients"),fetch("/api/products"),fetch("/api/orders"),fetch("/api/fabricas")]);e.ok&&o(await e.json()),t.ok&&i(await t.json()),a.ok&&n(await a.json()),s.ok&&h(await s.json())}catch(e){console.error("Error fetching data:",e),b("Erro ao carregar dados","error")}finally{p(!1)}},[b]);(0,r.useEffect)(()=>{N();let e=localStorage.getItem("frplus_user");e&&g(e)},[N]);let w=async e=>{try{let t=await fetch("/api/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){let e=await t.json();o(t=>[...t,e]),b("Cliente cadastrado com sucesso!","success")}else b("Erro ao cadastrar cliente","error")}catch(e){console.error("Error adding client:",e),b("Erro ao cadastrar cliente","error")}},v=async(e,t)=>{try{let a=await fetch("/api/clients/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(a.ok){let t=await a.json();o(a=>a.map(a=>a.id===e?t:a)),b("Cliente atualizado com sucesso!","success")}}catch(e){console.error("Error updating client:",e),b("Erro ao atualizar cliente","error")}},E=async e=>{try{(await fetch("/api/clients/".concat(e),{method:"DELETE"})).ok&&(o(t=>t.filter(t=>t.id!==e)),b("Cliente exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing client:",e),b("Erro ao excluir cliente","error")}},k=async e=>{try{(await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await N(),b("Produto cadastrado com sucesso!","success")):b("Erro ao cadastrar produto","error")}catch(e){console.error("Error adding product:",e),b("Erro ao cadastrar produto","error")}},C=async(e,t)=>{try{(await fetch("/api/products/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok&&(await N(),b("Produto atualizado com sucesso!","success"))}catch(e){console.error("Error updating product:",e),b("Erro ao atualizar produto","error")}},T=async e=>{try{(await fetch("/api/products/".concat(e),{method:"DELETE"})).ok&&(i(t=>t.filter(t=>t.id!==e)),b("Produto exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing product:",e),b("Erro ao excluir produto","error")}},S=async e=>{try{(await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await N(),b("Pedido cadastrado com sucesso!","success")):b("Erro ao cadastrar pedido","error")}catch(e){console.error("Error adding order:",e),b("Erro ao cadastrar pedido","error")}},P=async(e,t)=>{try{(await fetch("/api/orders/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok&&(await N(),b("Pedido atualizado com sucesso!","success"))}catch(e){console.error("Error updating order:",e),b("Erro ao atualizar pedido","error")}},O=async e=>{try{(await fetch("/api/orders/".concat(e),{method:"DELETE"})).ok&&(n(t=>t.filter(t=>t.id!==e)),b("Pedido exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing order:",e),b("Erro ao excluir pedido","error")}},Z=async e=>{try{let t=await fetch("/api/fabricas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){let e=await t.json();h(t=>[...t,e]),b("F\xe1brica cadastrada com sucesso!","success")}}catch(e){console.error("Error adding fabrica:",e),b("Erro ao cadastrar f\xe1brica","error")}},z=async(e,t)=>{try{(await fetch("/api/fabricas/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok&&(await N(),b("F\xe1brica atualizada com sucesso!","success"))}catch(e){console.error("Error updating fabrica:",e),b("Erro ao atualizar f\xe1brica","error")}},D=async e=>{try{(await fetch("/api/fabricas/".concat(e),{method:"DELETE"})).ok&&(h(t=>t.filter(t=>t.id!==e)),b("F\xe1brica exclu\xedda com sucesso!","success"))}catch(e){console.error("Error removing fabrica:",e),b("Erro ao excluir f\xe1brica","error")}};return(0,s.jsxs)(x.Provider,{value:{clients:a,products:c,orders:l,fabricas:d,loading:m,addClient:w,updateClient:v,removeClient:E,addProduct:k,updateProduct:C,removeProduct:T,addOrder:S,updateOrder:P,removeOrder:O,addFabrica:Z,updateFabrica:z,removeFabrica:D,getDashboardStats:()=>({totalSales:l.reduce((e,t)=>e+t.valorTotal,0),totalOrders:l.length,newClients:a.length,totalProducts:c.length}),showToast:b,user:f,login:e=>{g(e),localStorage.setItem("frplus_user",e)},logout:()=>{g(null),localStorage.removeItem("frplus_user")},refreshData:N},children:[t,y&&(0,s.jsx)(u,{message:y.message,type:y.type,onClose:()=>j(null)})]})}function m(){let e=(0,r.useContext)(x);if(void 0===e)throw Error("useData must be used within a DataProvider");return e}}},function(e){e.O(0,[462,792,76,971,69,744],function(){return e(e.s=51059)}),_N_E=e.O()}]);