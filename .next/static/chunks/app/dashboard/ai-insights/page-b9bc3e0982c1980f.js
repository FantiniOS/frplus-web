(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[494],{71046:function(e,t,s){Promise.resolve().then(s.bind(s,2356))},87461:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(64090),i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),r=(e,t)=>{let s=(0,a.forwardRef)((s,r)=>{let{color:n="currentColor",size:c=24,strokeWidth:o=2,absoluteStrokeWidth:d,className:x="",children:p,...h}=s;return(0,a.createElement)("svg",{ref:r,...i,width:c,height:c,stroke:n,strokeWidth:d?24*Number(o)/Number(c):o,className:["lucide","lucide-".concat(l(e)),x].join(" "),...h},[...t.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(p)?p:[p]])});return s.displayName="".concat(e),s}},61524:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(87461).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},53879:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(87461).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},37211:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(87461).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},95200:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(87461).Z)("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]])},67366:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(87461).Z)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]])},40834:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(87461).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},29733:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(87461).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},2356:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var a=s(3827),i=s(64090),l=s(8792),r=s(61524),n=s(95200),c=s(29733),o=s(53879),d=s(40834),x=s(37211),p=s(67366),h=s(87461);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,h.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),m=(0,h.Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);function g(){let[e,t]=(0,i.useState)("inactive"),[s,h]=(0,i.useState)(15),[g,y]=(0,i.useState)(!0),[j,b]=(0,i.useState)([]),[N,f]=(0,i.useState)([]),[v,w]=(0,i.useState)([]),[k,Z]=(0,i.useState)({inactive:{total:0,vermelho:0,laranja:0,amarelo:0},opportunities:{total:0,upgrade:0,crossSell:0,seasonal:0},insights:{total:0,lowTicket:0,decliningVolume:0,untappedPotential:0}}),D=(0,i.useCallback)(async()=>{y(!0);try{let[e,t,a]=await Promise.all([fetch("/api/ai/inactive-clients?days=".concat(s)),fetch("/api/ai/opportunities"),fetch("/api/ai/sales-insights")]);if(e.ok){let t=await e.json();b(t.clients||[]),Z(e=>({...e,inactive:t.summary}))}if(t.ok){let e=await t.json();f(e.opportunities||[]),Z(t=>({...t,opportunities:e.summary}))}if(a.ok){let e=await a.json();w(e.insights||[]),Z(t=>({...t,insights:e.summary}))}}catch(e){console.error("Error fetching AI data:",e)}finally{y(!1)}},[s]);(0,i.useEffect)(()=>{D()},[D]);let C={vermelho:"bg-red-500/20 text-red-400 border-red-500/30",laranja:"bg-orange-500/20 text-orange-400 border-orange-500/30",amarelo:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",verde:"bg-green-500/20 text-green-400 border-green-500/30"},A={alta:"bg-red-500/10 text-red-400 border-red-500/20",media:"bg-yellow-500/10 text-yellow-400 border-yellow-500/20",baixa:"bg-green-500/10 text-green-400 border-green-500/20"},L=[{id:"inactive",label:"Clientes Inativos",icon:r.Z,color:"text-red-400",count:k.inactive.total},{id:"opportunities",label:"Oportunidades",icon:n.Z,color:"text-yellow-400",count:k.opportunities.total},{id:"insights",label:"Alavancagem",icon:c.Z,color:"text-blue-400",count:k.insights.total}];return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(l.default,{href:"/dashboard",className:"rounded-lg bg-white/5 p-2 hover:bg-white/10 transition-colors",children:(0,a.jsx)(o.Z,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Intelig\xeancia Comercial"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"An\xe1lise de clientes e oportunidades de neg\xf3cio"})]})]}),(0,a.jsxs)("button",{onClick:D,disabled:g,className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-purple-600/20 text-purple-400 hover:bg-purple-600/30 transition-colors disabled:opacity-50",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 ".concat(g?"animate-spin":"")}),"Atualizar"]})]}),(0,a.jsx)("div",{className:"flex gap-2 p-1 rounded-xl bg-white/5",children:L.map(s=>(0,a.jsxs)("button",{onClick:()=>t(s.id),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-lg text-sm font-medium transition-all ".concat(e===s.id?"bg-white/10 text-white":"text-gray-400 hover:text-white hover:bg-white/5"),children:[(0,a.jsx)(s.icon,{className:"h-4 w-4 ".concat(e===s.id?s.color:"")}),s.label,(0,a.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded-full ".concat(e===s.id?"bg-white/20":"bg-white/5"),children:s.count})]},s.id))}),(0,a.jsx)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-6 backdrop-blur-sm",children:g?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)("div",{className:"w-8 h-8 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"})}):(0,a.jsxs)(a.Fragment,{children:["inactive"===e&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 pb-4 border-b border-white/10",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Mostrar clientes inativos h\xe1:"}),[15,30,60].map(e=>(0,a.jsxs)("button",{onClick:()=>h(e),className:"px-3 py-1 rounded-lg text-sm transition-colors ".concat(s===e?"bg-purple-600 text-white":"bg-white/5 text-gray-400 hover:bg-white/10"),children:[e,"+ dias"]},e))]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-white/5 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-white",children:k.inactive.total}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"Total"})]}),(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-red-500/10 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-red-400",children:k.inactive.vermelho}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"60+ dias"})]}),(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-orange-500/10 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-orange-400",children:k.inactive.laranja}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"30-59 dias"})]}),(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-yellow-500/10 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-400",children:k.inactive.amarelo}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"15-29 dias"})]})]}),(0,a.jsxs)("div",{className:"overflow-x-auto",children:[(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{className:"bg-white/5 text-xs uppercase text-gray-400",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Cliente"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Cidade"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center",children:"Dias Inativo"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right",children:"Total Gasto"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center",children:"Pedidos"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center",children:"A\xe7\xf5es"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-white/5",children:j.map(e=>{var t;return(0,a.jsxs)("tr",{className:"hover:bg-white/5",children:[(0,a.jsxs)("td",{className:"px-4 py-3",children:[(0,a.jsx)("p",{className:"font-medium text-white",children:e.nomeFantasia}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.razaoSocial})]}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-300",children:e.cidade}),(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(C[e.alertLevel]),children:e.diasInativo?"".concat(e.diasInativo," dias"):"Nunca comprou"})}),(0,a.jsxs)("td",{className:"px-4 py-3 text-right text-white",children:["R$ ",e.totalGasto.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),(0,a.jsx)("td",{className:"px-4 py-3 text-center text-gray-300",children:e.totalPedidos}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("a",{href:"https://wa.me/55".concat(null===(t=e.celular||e.telefone)||void 0===t?void 0:t.replace(/\D/g,"")),target:"_blank",className:"p-2 rounded-lg bg-green-500/10 text-green-400 hover:bg-green-500/20 transition-colors",title:"WhatsApp",children:(0,a.jsx)(p.Z,{className:"h-4 w-4"})}),(0,a.jsx)("a",{href:"mailto:".concat(e.email),className:"p-2 rounded-lg bg-blue-500/10 text-blue-400 hover:bg-blue-500/20 transition-colors",title:"Email",children:(0,a.jsx)(u,{className:"h-4 w-4"})}),(0,a.jsx)("a",{href:"tel:".concat(e.telefone),className:"p-2 rounded-lg bg-purple-500/10 text-purple-400 hover:bg-purple-500/20 transition-colors",title:"Ligar",children:(0,a.jsx)(m,{className:"h-4 w-4"})})]})})]},e.id)})})]}),0===j.length&&(0,a.jsx)("p",{className:"text-center text-gray-500 py-8",children:"Nenhum cliente inativo encontrado"})]})]}),"opportunities"===e&&(0,a.jsx)("div",{className:"space-y-4",children:0===N.length?(0,a.jsx)("p",{className:"text-center text-gray-500 py-8",children:"Nenhuma oportunidade identificada"}):(0,a.jsx)("div",{className:"grid gap-3",children:N.map((e,t)=>(0,a.jsxs)("div",{className:"p-4 rounded-lg bg-white/5 hover:bg-white/10 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-lg",children:"upgrade"===e.type?"⬆️":"crossSell"===e.type?"\uD83D\uDED2":"seasonal"===e.type?"\uD83D\uDCC5":"\uD83D\uDD04"}),(0,a.jsx)("p",{className:"font-medium text-white",children:e.clienteNome})]}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs border ".concat(A[e.priority]),children:e.priority})]}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mb-3",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-xs text-purple-400 uppercase",children:e.type}),(0,a.jsx)("button",{className:"px-3 py-1 rounded-lg bg-purple-600/20 text-purple-400 text-sm hover:bg-purple-600/30 transition-colors",children:e.actionLabel})]})]},t))})}),"insights"===e&&(0,a.jsx)("div",{className:"space-y-4",children:0===v.length?(0,a.jsx)("p",{className:"text-center text-gray-500 py-8",children:"Nenhum insight dispon\xedvel"}):(0,a.jsx)("div",{className:"grid gap-3",children:v.map((e,t)=>(0,a.jsxs)("div",{className:"p-4 rounded-lg bg-white/5 hover:bg-white/10 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-lg",children:"lowTicket"===e.type?"\uD83D\uDCB0":"decliningVolume"===e.type?"\uD83D\uDCC9":"\uD83C\uDFAF"}),(0,a.jsx)("p",{className:"font-medium text-white",children:e.clienteNome})]}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs border ".concat(A[e.priority]),children:e.priority})]}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:e.description}),(0,a.jsx)("p",{className:"text-sm text-blue-400 mt-1",children:e.metric}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,a.jsx)("span",{className:"text-xs text-purple-400 uppercase",children:e.type}),(0,a.jsx)("button",{className:"px-3 py-1 rounded-lg bg-blue-600/20 text-blue-400 text-sm hover:bg-blue-600/30 transition-colors",children:e.actionLabel})]})]},t))})})]})})]})}}},function(e){e.O(0,[792,971,69,744],function(){return e(e.s=71046)}),_N_E=e.O()}]);