(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[365],{73318:function(e,a,s){Promise.resolve().then(s.bind(s,39725))},39725:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return j}});var o=s(3827),r=s(8792),c=s(53879),t=s(70699),i=s(80559),l=s(18994),n=s(28670),d=s(11213),p=s(62457),u=s(48219),h=s(5590),m=s(64090),x=s(47907);function j(e){let{params:a}=e,{clients:s,updateClient:j,showToast:b}=(0,h.e)(),f=(0,x.useRouter)(),[g,v]=(0,m.useState)({}),[N,y]=(0,m.useState)(!1),[w,E]=(0,m.useState)(!1);(0,m.useEffect)(()=>{let e=s.find(e=>e.id===a.id);e&&v(e)},[s,a.id]);let C=e=>{let{name:a,value:s}=e.target;v(e=>({...e,[a]:s}))},S=async()=>{var e;let a=null===(e=g.cnpj)||void 0===e?void 0:e.replace(/\D/g,"");if(!a||14!==a.length){b("CNPJ inv\xe1lido (14 d\xedgitos)","error");return}y(!0);try{let e=await fetch("https://brasilapi.com.br/api/cnpj/v1/".concat(a));if(!e.ok)throw Error("CNPJ n\xe3o encontrado");let s=await e.json();v(e=>{var a;return{...e,razaoSocial:s.razao_social||e.razaoSocial,nomeFantasia:s.nome_fantasia||e.nomeFantasia,cep:(null===(a=s.cep)||void 0===a?void 0:a.replace(/\D/g,""))||e.cep,endereco:s.logradouro||e.endereco,bairro:s.bairro||e.bairro,cidade:s.municipio||e.cidade,estado:s.uf||e.estado}}),b("Dados do CNPJ carregados!","success")}catch(e){b("CNPJ n\xe3o encontrado","error")}finally{y(!1)}},P=async()=>{var e;let a=null===(e=g.cep)||void 0===e?void 0:e.replace(/\D/g,"");if(!a||8!==a.length){b("CEP inv\xe1lido (8 d\xedgitos)","error");return}E(!0);try{let e=await fetch("https://viacep.com.br/ws/".concat(a,"/json/")),s=await e.json();if(s.erro)throw Error("CEP n\xe3o encontrado");v(e=>({...e,endereco:s.logradouro||e.endereco,bairro:s.bairro||e.bairro,cidade:s.localidade||e.cidade,uf:s.uf||e.uf})),b("Endere\xe7o carregado!","success")}catch(e){b("CEP n\xe3o encontrado","error")}finally{E(!1)}},k=e=>{if(e.preventDefault(),!g.razaoSocial||!g.cnpj){b("Preencha Raz\xe3o Social e CNPJ","error");return}if(g.id){let e={...g,nome:g.razaoSocial};j(g.id,e),f.push("/dashboard/clientes")}};return(0,o.jsxs)("div",{className:"max-w-2xl mx-auto space-y-4",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"flex items-center gap-3",children:[(0,o.jsx)(r.default,{href:"/dashboard/clientes",className:"p-1.5 rounded-lg hover:bg-white/10 text-gray-400",children:(0,o.jsx)(c.Z,{className:"h-5 w-5"})}),(0,o.jsx)("h1",{className:"text-xl font-bold text-white",children:"Editar Cliente"})]}),(0,o.jsxs)("button",{onClick:k,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-1.5 text-sm font-medium text-white hover:bg-blue-500",children:[(0,o.jsx)(t.Z,{className:"h-4 w-4"})," Salvar"]})]}),(0,o.jsxs)("form",{className:"space-y-4",onSubmit:k,children:[(0,o.jsxs)("div",{className:"form-card",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-white/5",children:[(0,o.jsx)(i.Z,{className:"h-4 w-4 text-blue-400"}),(0,o.jsx)("span",{className:"text-sm font-medium text-white",children:"Dados da Empresa"})]}),(0,o.jsxs)("div",{className:"grid gap-3 grid-cols-2",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"CNPJ *"}),(0,o.jsxs)("div",{className:"flex gap-1",children:[(0,o.jsx)("input",{name:"cnpj",value:g.cnpj||"",onChange:C,className:"input-compact flex-1"}),(0,o.jsx)("button",{type:"button",onClick:S,disabled:N,className:"px-2 rounded-lg bg-blue-600/20 text-blue-400 hover:bg-blue-600/30 disabled:opacity-50",title:"Buscar dados pelo CNPJ",children:N?(0,o.jsx)(l.Z,{className:"h-4 w-4 animate-spin"}):(0,o.jsx)(n.Z,{className:"h-4 w-4"})})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"Inscri\xe7\xe3o Estadual"}),(0,o.jsx)("input",{name:"inscricaoEstadual",value:g.inscricaoEstadual||"",onChange:C,className:"input-compact"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"Raz\xe3o Social *"}),(0,o.jsx)("input",{name:"razaoSocial",value:g.razaoSocial||"",onChange:C,className:"input-compact"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"Nome Fantasia"}),(0,o.jsx)("input",{name:"nomeFantasia",value:g.nomeFantasia||"",onChange:C,className:"input-compact"})]})]})]}),(0,o.jsxs)("div",{className:"form-card",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-white/5",children:[(0,o.jsx)(d.Z,{className:"h-4 w-4 text-purple-400"}),(0,o.jsx)("span",{className:"text-sm font-medium text-white",children:"Contato"})]}),(0,o.jsxs)("div",{className:"grid gap-3 grid-cols-3",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"Email"}),(0,o.jsx)("input",{name:"email",type:"email",value:g.email||"",onChange:C,placeholder:"contato@empresa.com",className:"input-compact"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"Telefone Fixo"}),(0,o.jsx)("input",{name:"telefone",value:g.telefone||"",onChange:C,placeholder:"(00) 0000-0000",className:"input-compact"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"Celular / WhatsApp"}),(0,o.jsx)("input",{name:"celular",value:g.celular||"",onChange:C,placeholder:"(00) 90000-0000",className:"input-compact"})]})]})]}),(0,o.jsxs)("div",{className:"form-card",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-white/5",children:[(0,o.jsx)(p.Z,{className:"h-4 w-4 text-orange-400"}),(0,o.jsx)("span",{className:"text-sm font-medium text-white",children:"Localiza\xe7\xe3o"})]}),(0,o.jsxs)("div",{className:"grid gap-3 grid-cols-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"CEP"}),(0,o.jsxs)("div",{className:"flex gap-1",children:[(0,o.jsx)("input",{name:"cep",value:g.cep||"",onChange:C,className:"input-compact flex-1"}),(0,o.jsx)("button",{type:"button",onClick:P,disabled:w,className:"px-2 rounded-lg bg-orange-600/20 text-orange-400 hover:bg-orange-600/30 disabled:opacity-50",title:"Buscar endere\xe7o pelo CEP",children:w?(0,o.jsx)(l.Z,{className:"h-4 w-4 animate-spin"}):(0,o.jsx)(n.Z,{className:"h-4 w-4"})})]})]}),(0,o.jsxs)("div",{className:"col-span-3",children:[(0,o.jsx)("label",{className:"label-compact",children:"Endere\xe7o"}),(0,o.jsx)("input",{name:"endereco",value:g.endereco||"",onChange:C,className:"input-compact"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"N\xfamero"}),(0,o.jsx)("input",{name:"numero",value:g.numero||"",onChange:C,className:"input-compact"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"Bairro"}),(0,o.jsx)("input",{name:"bairro",value:g.bairro||"",onChange:C,className:"input-compact"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"Cidade"}),(0,o.jsx)("input",{name:"cidade",value:g.cidade||"",onChange:C,className:"input-compact"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"UF"}),(0,o.jsxs)("select",{name:"uf",value:g.uf||"",onChange:C,className:"input-compact",children:[(0,o.jsx)("option",{value:"",children:"-"}),(0,o.jsx)("option",{children:"AC"}),(0,o.jsx)("option",{children:"AL"}),(0,o.jsx)("option",{children:"AP"}),(0,o.jsx)("option",{children:"AM"}),(0,o.jsx)("option",{children:"BA"}),(0,o.jsx)("option",{children:"CE"}),(0,o.jsx)("option",{children:"DF"}),(0,o.jsx)("option",{children:"ES"}),(0,o.jsx)("option",{children:"GO"}),(0,o.jsx)("option",{children:"MA"}),(0,o.jsx)("option",{children:"MT"}),(0,o.jsx)("option",{children:"MS"}),(0,o.jsx)("option",{children:"MG"}),(0,o.jsx)("option",{children:"PA"}),(0,o.jsx)("option",{children:"PB"}),(0,o.jsx)("option",{children:"PR"}),(0,o.jsx)("option",{children:"PE"}),(0,o.jsx)("option",{children:"PI"}),(0,o.jsx)("option",{children:"RJ"}),(0,o.jsx)("option",{children:"RN"}),(0,o.jsx)("option",{children:"RS"}),(0,o.jsx)("option",{children:"RO"}),(0,o.jsx)("option",{children:"RR"}),(0,o.jsx)("option",{children:"SC"}),(0,o.jsx)("option",{children:"SP"}),(0,o.jsx)("option",{children:"SE"}),(0,o.jsx)("option",{children:"TO"})]})]})]})]}),(0,o.jsxs)("div",{className:"form-card",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-white/5",children:[(0,o.jsx)(u.Z,{className:"h-4 w-4 text-green-400"}),(0,o.jsx)("span",{className:"text-sm font-medium text-white",children:"Perfil Comercial"})]}),(0,o.jsxs)("div",{className:"grid gap-3 grid-cols-2",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"Tabela de Pre\xe7o"}),(0,o.jsxs)("select",{name:"tabelaPreco",value:g.tabelaPreco||"",onChange:C,className:"input-compact",children:[(0,o.jsx)("option",{value:"",children:"Selecione..."}),(0,o.jsx)("option",{value:"50a199",children:"50 a 199 CX"}),(0,o.jsx)("option",{value:"200a699",children:"200 a 699 CX"}),(0,o.jsx)("option",{value:"atacado",children:"Atacado"}),(0,o.jsx)("option",{value:"atacadoAVista",children:"Atacado \xe0 Vista"}),(0,o.jsx)("option",{value:"redes",children:"Redes"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"Limite de Cr\xe9dito (R$)"}),(0,o.jsx)("input",{name:"limiteCredito",type:"number",value:g.limiteCredito||0,onChange:C,className:"input-compact"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"Status"}),(0,o.jsxs)("select",{name:"status",value:g.status||"Ativo",onChange:C,className:"input-compact",children:[(0,o.jsx)("option",{children:"Ativo"}),(0,o.jsx)("option",{children:"Inativo"}),(0,o.jsx)("option",{children:"Bloqueado"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"label-compact",children:"Observa\xe7\xf5es"}),(0,o.jsx)("input",{name:"observacoes",value:g.observacoes||"",onChange:C,className:"input-compact"})]})]})]})]})]})}},5590:function(e,a,s){"use strict";s.d(a,{F:function(){return h},e:function(){return m}});var o=s(3827),r=s(64090),c=s(46578),t=s(98998),i=s(28814),l=s(52235),n=s(28745),d=s(38371);function p(e){let{message:a,type:s,isVisible:p=!0,onClose:u}=e;return(0,r.useEffect)(()=>{if(p){let e=setTimeout(()=>{u()},3e3);return()=>clearTimeout(e)}},[p,u]),(0,o.jsx)(n.M,{children:p&&(0,o.jsxs)(d.E.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},className:"fixed bottom-6 right-6 z-50 flex items-center gap-3 rounded-xl border border-white/10 bg-black/80 px-4 py-3 text-sm text-white shadow-2xl backdrop-blur-md",children:[(0,o.jsxs)("div",{className:"rounded-full p-1 ".concat("success"===s?"bg-green-500/20 text-green-500":"error"===s?"bg-red-500/20 text-red-500":"bg-blue-500/20 text-blue-500"),children:["success"===s&&(0,o.jsx)(c.Z,{className:"h-4 w-4"}),"error"===s&&(0,o.jsx)(t.Z,{className:"h-4 w-4"}),"info"===s&&(0,o.jsx)(i.Z,{className:"h-4 w-4"})]}),(0,o.jsx)("span",{className:"font-medium pr-2",children:a}),(0,o.jsx)("button",{onClick:u,className:"ml-2 rounded-lg p-1 text-gray-400 hover:bg-white/10 hover:text-white transition-colors",children:(0,o.jsx)(l.Z,{className:"h-3 w-3"})})]})})}let u=(0,r.createContext)(void 0);function h(e){let{children:a}=e,[s,c]=(0,r.useState)([]),[t,i]=(0,r.useState)([]),[l,n]=(0,r.useState)([]),[d,h]=(0,r.useState)([]),[m,x]=(0,r.useState)(!0),[j,b]=(0,r.useState)(null),[f,g]=(0,r.useState)(null),v=(0,r.useCallback)((e,a)=>{g({message:e,type:a})},[]),N=(0,r.useCallback)(async()=>{x(!0);try{let[e,a,s,o]=await Promise.all([fetch("/api/clients"),fetch("/api/products"),fetch("/api/orders"),fetch("/api/fabricas")]);e.ok&&c(await e.json()),a.ok&&i(await a.json()),s.ok&&n(await s.json()),o.ok&&h(await o.json())}catch(e){console.error("Error fetching data:",e),v("Erro ao carregar dados","error")}finally{x(!1)}},[v]);(0,r.useEffect)(()=>{N();let e=localStorage.getItem("frplus_user");e&&b(e)},[N]);let y=async e=>{try{let a=await fetch("/api/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok){let e=await a.json();c(a=>[...a,e]),v("Cliente cadastrado com sucesso!","success")}else v("Erro ao cadastrar cliente","error")}catch(e){console.error("Error adding client:",e),v("Erro ao cadastrar cliente","error")}},w=async(e,a)=>{try{let s=await fetch("/api/clients/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(s.ok){let a=await s.json();c(s=>s.map(s=>s.id===e?a:s)),v("Cliente atualizado com sucesso!","success")}}catch(e){console.error("Error updating client:",e),v("Erro ao atualizar cliente","error")}},E=async e=>{try{(await fetch("/api/clients/".concat(e),{method:"DELETE"})).ok&&(c(a=>a.filter(a=>a.id!==e)),v("Cliente exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing client:",e),v("Erro ao excluir cliente","error")}},C=async e=>{try{(await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await N(),v("Produto cadastrado com sucesso!","success")):v("Erro ao cadastrar produto","error")}catch(e){console.error("Error adding product:",e),v("Erro ao cadastrar produto","error")}},S=async(e,a)=>{try{(await fetch("/api/products/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok&&(await N(),v("Produto atualizado com sucesso!","success"))}catch(e){console.error("Error updating product:",e),v("Erro ao atualizar produto","error")}},P=async e=>{try{(await fetch("/api/products/".concat(e),{method:"DELETE"})).ok&&(i(a=>a.filter(a=>a.id!==e)),v("Produto exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing product:",e),v("Erro ao excluir produto","error")}},k=async e=>{try{(await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await N(),v("Pedido cadastrado com sucesso!","success")):v("Erro ao cadastrar pedido","error")}catch(e){console.error("Error adding order:",e),v("Erro ao cadastrar pedido","error")}},T=async(e,a)=>{try{(await fetch("/api/orders/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok&&(await N(),v("Pedido atualizado com sucesso!","success"))}catch(e){console.error("Error updating order:",e),v("Erro ao atualizar pedido","error")}},z=async e=>{try{(await fetch("/api/orders/".concat(e),{method:"DELETE"})).ok&&(n(a=>a.filter(a=>a.id!==e)),v("Pedido exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing order:",e),v("Erro ao excluir pedido","error")}},O=async e=>{try{let a=await fetch("/api/fabricas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok){let e=await a.json();h(a=>[...a,e]),v("F\xe1brica cadastrada com sucesso!","success")}}catch(e){console.error("Error adding fabrica:",e),v("Erro ao cadastrar f\xe1brica","error")}},J=async(e,a)=>{try{(await fetch("/api/fabricas/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok&&(await N(),v("F\xe1brica atualizada com sucesso!","success"))}catch(e){console.error("Error updating fabrica:",e),v("Erro ao atualizar f\xe1brica","error")}},D=async e=>{try{(await fetch("/api/fabricas/".concat(e),{method:"DELETE"})).ok&&(h(a=>a.filter(a=>a.id!==e)),v("F\xe1brica exclu\xedda com sucesso!","success"))}catch(e){console.error("Error removing fabrica:",e),v("Erro ao excluir f\xe1brica","error")}};return(0,o.jsxs)(u.Provider,{value:{clients:s,products:t,orders:l,fabricas:d,loading:m,addClient:y,updateClient:w,removeClient:E,addProduct:C,updateProduct:S,removeProduct:P,addOrder:k,updateOrder:T,removeOrder:z,addFabrica:O,updateFabrica:J,removeFabrica:D,getDashboardStats:()=>({totalSales:l.reduce((e,a)=>e+a.valorTotal,0),totalOrders:l.length,newClients:s.length,totalProducts:t.length}),showToast:v,user:j,login:e=>{b(e),localStorage.setItem("frplus_user",e)},logout:()=>{b(null),localStorage.removeItem("frplus_user")},refreshData:N},children:[a,f&&(0,o.jsx)(p,{message:f.message,type:f.type,onClose:()=>g(null)})]})}function m(){let e=(0,r.useContext)(u);if(void 0===e)throw Error("useData must be used within a DataProvider");return e}}},function(e){e.O(0,[462,792,186,971,69,744],function(){return e(e.s=73318)}),_N_E=e.O()}]);