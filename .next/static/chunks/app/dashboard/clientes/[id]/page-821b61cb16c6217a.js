(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[365],{73318:function(e,a,o){Promise.resolve().then(o.bind(o,39725))},39725:function(e,a,o){"use strict";o.r(a),o.d(a,{default:function(){return x}});var r=o(3827),s=o(8792),t=o(53879),c=o(70699),i=o(80559),n=o(18994),l=o(28670),d=o(62457),u=o(48219),p=o(5590),h=o(64090),m=o(47907);function x(e){let{params:a}=e,{clients:o,updateClient:x,showToast:j}=(0,p.e)(),b=(0,m.useRouter)(),[f,g]=(0,h.useState)({}),[v,N]=(0,h.useState)(!1),[y,E]=(0,h.useState)(!1);(0,h.useEffect)(()=>{let e=o.find(e=>e.id===a.id);e&&g(e)},[o,a.id]);let w=e=>{let{name:a,value:o}=e.target;g(e=>({...e,[a]:o}))},C=async()=>{var e;let a=null===(e=f.cnpj)||void 0===e?void 0:e.replace(/\D/g,"");if(!a||14!==a.length){j("CNPJ inv\xe1lido (14 d\xedgitos)","error");return}N(!0);try{let e=await fetch("https://brasilapi.com.br/api/cnpj/v1/".concat(a));if(!e.ok)throw Error("CNPJ n\xe3o encontrado");let o=await e.json();g(e=>{var a;return{...e,razaoSocial:o.razao_social||e.razaoSocial,nomeFantasia:o.nome_fantasia||e.nomeFantasia,cep:(null===(a=o.cep)||void 0===a?void 0:a.replace(/\D/g,""))||e.cep,endereco:o.logradouro||e.endereco,bairro:o.bairro||e.bairro,cidade:o.municipio||e.cidade,estado:o.uf||e.estado}}),j("Dados do CNPJ carregados!","success")}catch(e){j("CNPJ n\xe3o encontrado","error")}finally{N(!1)}},S=async()=>{var e;let a=null===(e=f.cep)||void 0===e?void 0:e.replace(/\D/g,"");if(!a||8!==a.length){j("CEP inv\xe1lido (8 d\xedgitos)","error");return}E(!0);try{let e=await fetch("https://viacep.com.br/ws/".concat(a,"/json/")),o=await e.json();if(o.erro)throw Error("CEP n\xe3o encontrado");g(e=>({...e,endereco:o.logradouro||e.endereco,bairro:o.bairro||e.bairro,cidade:o.localidade||e.cidade,uf:o.uf||e.uf})),j("Endere\xe7o carregado!","success")}catch(e){j("CEP n\xe3o encontrado","error")}finally{E(!1)}},P=e=>{if(e.preventDefault(),!f.razaoSocial||!f.cnpj){j("Preencha Raz\xe3o Social e CNPJ","error");return}if(f.id){let e={...f,nome:f.razaoSocial};x(f.id,e),b.push("/dashboard/clientes")}};return(0,r.jsxs)("div",{className:"max-w-2xl mx-auto space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(s.default,{href:"/dashboard/clientes",className:"p-1.5 rounded-lg hover:bg-white/10 text-gray-400",children:(0,r.jsx)(t.Z,{className:"h-5 w-5"})}),(0,r.jsx)("h1",{className:"text-xl font-bold text-white",children:"Editar Cliente"})]}),(0,r.jsxs)("button",{onClick:P,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-1.5 text-sm font-medium text-white hover:bg-blue-500",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4"})," Salvar"]})]}),(0,r.jsxs)("form",{className:"space-y-4",onSubmit:P,children:[(0,r.jsxs)("div",{className:"form-card",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-white/5",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4 text-blue-400"}),(0,r.jsx)("span",{className:"text-sm font-medium text-white",children:"Dados da Empresa"})]}),(0,r.jsxs)("div",{className:"grid gap-3 grid-cols-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"CNPJ *"}),(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)("input",{name:"cnpj",value:f.cnpj||"",onChange:w,className:"input-compact flex-1"}),(0,r.jsx)("button",{type:"button",onClick:C,disabled:v,className:"px-2 rounded-lg bg-blue-600/20 text-blue-400 hover:bg-blue-600/30 disabled:opacity-50",title:"Buscar dados pelo CNPJ",children:v?(0,r.jsx)(n.Z,{className:"h-4 w-4 animate-spin"}):(0,r.jsx)(l.Z,{className:"h-4 w-4"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Inscri\xe7\xe3o Estadual"}),(0,r.jsx)("input",{name:"inscricaoEstadual",value:f.inscricaoEstadual||"",onChange:w,className:"input-compact"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Raz\xe3o Social *"}),(0,r.jsx)("input",{name:"razaoSocial",value:f.razaoSocial||"",onChange:w,className:"input-compact"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Nome Fantasia"}),(0,r.jsx)("input",{name:"nomeFantasia",value:f.nomeFantasia||"",onChange:w,className:"input-compact"})]})]})]}),(0,r.jsxs)("div",{className:"form-card",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-white/5",children:[(0,r.jsx)(d.Z,{className:"h-4 w-4 text-orange-400"}),(0,r.jsx)("span",{className:"text-sm font-medium text-white",children:"Localiza\xe7\xe3o"})]}),(0,r.jsxs)("div",{className:"grid gap-3 grid-cols-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"CEP"}),(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)("input",{name:"cep",value:f.cep||"",onChange:w,className:"input-compact flex-1"}),(0,r.jsx)("button",{type:"button",onClick:S,disabled:y,className:"px-2 rounded-lg bg-orange-600/20 text-orange-400 hover:bg-orange-600/30 disabled:opacity-50",title:"Buscar endere\xe7o pelo CEP",children:y?(0,r.jsx)(n.Z,{className:"h-4 w-4 animate-spin"}):(0,r.jsx)(l.Z,{className:"h-4 w-4"})})]})]}),(0,r.jsxs)("div",{className:"col-span-3",children:[(0,r.jsx)("label",{className:"label-compact",children:"Endere\xe7o"}),(0,r.jsx)("input",{name:"endereco",value:f.endereco||"",onChange:w,className:"input-compact"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"N\xfamero"}),(0,r.jsx)("input",{name:"numero",value:f.numero||"",onChange:w,className:"input-compact"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Bairro"}),(0,r.jsx)("input",{name:"bairro",value:f.bairro||"",onChange:w,className:"input-compact"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Cidade"}),(0,r.jsx)("input",{name:"cidade",value:f.cidade||"",onChange:w,className:"input-compact"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"UF"}),(0,r.jsxs)("select",{name:"uf",value:f.uf||"",onChange:w,className:"input-compact",children:[(0,r.jsx)("option",{value:"",children:"-"}),(0,r.jsx)("option",{children:"AC"}),(0,r.jsx)("option",{children:"AL"}),(0,r.jsx)("option",{children:"AP"}),(0,r.jsx)("option",{children:"AM"}),(0,r.jsx)("option",{children:"BA"}),(0,r.jsx)("option",{children:"CE"}),(0,r.jsx)("option",{children:"DF"}),(0,r.jsx)("option",{children:"ES"}),(0,r.jsx)("option",{children:"GO"}),(0,r.jsx)("option",{children:"MA"}),(0,r.jsx)("option",{children:"MT"}),(0,r.jsx)("option",{children:"MS"}),(0,r.jsx)("option",{children:"MG"}),(0,r.jsx)("option",{children:"PA"}),(0,r.jsx)("option",{children:"PB"}),(0,r.jsx)("option",{children:"PR"}),(0,r.jsx)("option",{children:"PE"}),(0,r.jsx)("option",{children:"PI"}),(0,r.jsx)("option",{children:"RJ"}),(0,r.jsx)("option",{children:"RN"}),(0,r.jsx)("option",{children:"RS"}),(0,r.jsx)("option",{children:"RO"}),(0,r.jsx)("option",{children:"RR"}),(0,r.jsx)("option",{children:"SC"}),(0,r.jsx)("option",{children:"SP"}),(0,r.jsx)("option",{children:"SE"}),(0,r.jsx)("option",{children:"TO"})]})]})]})]}),(0,r.jsxs)("div",{className:"form-card",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-white/5",children:[(0,r.jsx)(u.Z,{className:"h-4 w-4 text-green-400"}),(0,r.jsx)("span",{className:"text-sm font-medium text-white",children:"Perfil Comercial"})]}),(0,r.jsxs)("div",{className:"grid gap-3 grid-cols-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Tabela de Pre\xe7o"}),(0,r.jsxs)("select",{name:"tabelaPreco",value:f.tabelaPreco||"",onChange:w,className:"input-compact",children:[(0,r.jsx)("option",{value:"",children:"Selecione..."}),(0,r.jsx)("option",{value:"50a199",children:"50 a 199 CX"}),(0,r.jsx)("option",{value:"200a699",children:"200 a 699 CX"}),(0,r.jsx)("option",{value:"atacado",children:"Atacado"}),(0,r.jsx)("option",{value:"atacadoAVista",children:"Atacado \xe0 Vista"}),(0,r.jsx)("option",{value:"redes",children:"Redes"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Limite de Cr\xe9dito (R$)"}),(0,r.jsx)("input",{name:"limiteCredito",type:"number",value:f.limiteCredito||0,onChange:w,className:"input-compact"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Status"}),(0,r.jsxs)("select",{name:"status",value:f.status||"Ativo",onChange:w,className:"input-compact",children:[(0,r.jsx)("option",{children:"Ativo"}),(0,r.jsx)("option",{children:"Inativo"}),(0,r.jsx)("option",{children:"Bloqueado"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Observa\xe7\xf5es"}),(0,r.jsx)("input",{name:"observacoes",value:f.observacoes||"",onChange:w,className:"input-compact"})]})]})]})]})]})}},5590:function(e,a,o){"use strict";o.d(a,{F:function(){return h},e:function(){return m}});var r=o(3827),s=o(64090),t=o(46578),c=o(98998),i=o(28814),n=o(52235),l=o(28745),d=o(38371);function u(e){let{message:a,type:o,isVisible:u=!0,onClose:p}=e;return(0,s.useEffect)(()=>{if(u){let e=setTimeout(()=>{p()},3e3);return()=>clearTimeout(e)}},[u,p]),(0,r.jsx)(l.M,{children:u&&(0,r.jsxs)(d.E.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},className:"fixed bottom-6 right-6 z-50 flex items-center gap-3 rounded-xl border border-white/10 bg-black/80 px-4 py-3 text-sm text-white shadow-2xl backdrop-blur-md",children:[(0,r.jsxs)("div",{className:"rounded-full p-1 ".concat("success"===o?"bg-green-500/20 text-green-500":"error"===o?"bg-red-500/20 text-red-500":"bg-blue-500/20 text-blue-500"),children:["success"===o&&(0,r.jsx)(t.Z,{className:"h-4 w-4"}),"error"===o&&(0,r.jsx)(c.Z,{className:"h-4 w-4"}),"info"===o&&(0,r.jsx)(i.Z,{className:"h-4 w-4"})]}),(0,r.jsx)("span",{className:"font-medium pr-2",children:a}),(0,r.jsx)("button",{onClick:p,className:"ml-2 rounded-lg p-1 text-gray-400 hover:bg-white/10 hover:text-white transition-colors",children:(0,r.jsx)(n.Z,{className:"h-3 w-3"})})]})})}let p=(0,s.createContext)(void 0);function h(e){let{children:a}=e,[o,t]=(0,s.useState)([]),[c,i]=(0,s.useState)([]),[n,l]=(0,s.useState)([]),[d,h]=(0,s.useState)([]),[m,x]=(0,s.useState)(!0),[j,b]=(0,s.useState)(null),[f,g]=(0,s.useState)(null),v=(0,s.useCallback)((e,a)=>{g({message:e,type:a})},[]),N=(0,s.useCallback)(async()=>{x(!0);try{let[e,a,o,r]=await Promise.all([fetch("/api/clients"),fetch("/api/products"),fetch("/api/orders"),fetch("/api/fabricas")]);e.ok&&t(await e.json()),a.ok&&i(await a.json()),o.ok&&l(await o.json()),r.ok&&h(await r.json())}catch(e){console.error("Error fetching data:",e),v("Erro ao carregar dados","error")}finally{x(!1)}},[v]);(0,s.useEffect)(()=>{N();let e=localStorage.getItem("frplus_user");e&&b(e)},[N]);let y=async e=>{try{let a=await fetch("/api/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok){let e=await a.json();t(a=>[...a,e]),v("Cliente cadastrado com sucesso!","success")}else v("Erro ao cadastrar cliente","error")}catch(e){console.error("Error adding client:",e),v("Erro ao cadastrar cliente","error")}},E=async(e,a)=>{try{let o=await fetch("/api/clients/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(o.ok){let a=await o.json();t(o=>o.map(o=>o.id===e?a:o)),v("Cliente atualizado com sucesso!","success")}}catch(e){console.error("Error updating client:",e),v("Erro ao atualizar cliente","error")}},w=async e=>{try{(await fetch("/api/clients/".concat(e),{method:"DELETE"})).ok&&(t(a=>a.filter(a=>a.id!==e)),v("Cliente exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing client:",e),v("Erro ao excluir cliente","error")}},C=async e=>{try{(await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await N(),v("Produto cadastrado com sucesso!","success")):v("Erro ao cadastrar produto","error")}catch(e){console.error("Error adding product:",e),v("Erro ao cadastrar produto","error")}},S=async(e,a)=>{try{(await fetch("/api/products/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok&&(await N(),v("Produto atualizado com sucesso!","success"))}catch(e){console.error("Error updating product:",e),v("Erro ao atualizar produto","error")}},P=async e=>{try{(await fetch("/api/products/".concat(e),{method:"DELETE"})).ok&&(i(a=>a.filter(a=>a.id!==e)),v("Produto exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing product:",e),v("Erro ao excluir produto","error")}},k=async e=>{try{(await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await N(),v("Pedido cadastrado com sucesso!","success")):v("Erro ao cadastrar pedido","error")}catch(e){console.error("Error adding order:",e),v("Erro ao cadastrar pedido","error")}},T=async(e,a)=>{try{(await fetch("/api/orders/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok&&(await N(),v("Pedido atualizado com sucesso!","success"))}catch(e){console.error("Error updating order:",e),v("Erro ao atualizar pedido","error")}},z=async e=>{try{(await fetch("/api/orders/".concat(e),{method:"DELETE"})).ok&&(l(a=>a.filter(a=>a.id!==e)),v("Pedido exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing order:",e),v("Erro ao excluir pedido","error")}},O=async e=>{try{let a=await fetch("/api/fabricas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok){let e=await a.json();h(a=>[...a,e]),v("F\xe1brica cadastrada com sucesso!","success")}}catch(e){console.error("Error adding fabrica:",e),v("Erro ao cadastrar f\xe1brica","error")}},J=async(e,a)=>{try{(await fetch("/api/fabricas/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok&&(await N(),v("F\xe1brica atualizada com sucesso!","success"))}catch(e){console.error("Error updating fabrica:",e),v("Erro ao atualizar f\xe1brica","error")}},D=async e=>{try{(await fetch("/api/fabricas/".concat(e),{method:"DELETE"})).ok&&(h(a=>a.filter(a=>a.id!==e)),v("F\xe1brica exclu\xedda com sucesso!","success"))}catch(e){console.error("Error removing fabrica:",e),v("Erro ao excluir f\xe1brica","error")}};return(0,r.jsxs)(p.Provider,{value:{clients:o,products:c,orders:n,fabricas:d,loading:m,addClient:y,updateClient:E,removeClient:w,addProduct:C,updateProduct:S,removeProduct:P,addOrder:k,updateOrder:T,removeOrder:z,addFabrica:O,updateFabrica:J,removeFabrica:D,getDashboardStats:()=>({totalSales:n.reduce((e,a)=>e+a.valorTotal,0),totalOrders:n.length,newClients:o.length,totalProducts:c.length}),showToast:v,user:j,login:e=>{b(e),localStorage.setItem("frplus_user",e)},logout:()=>{b(null),localStorage.removeItem("frplus_user")},refreshData:N},children:[a,f&&(0,r.jsx)(u,{message:f.message,type:f.type,onClose:()=>g(null)})]})}function m(){let e=(0,s.useContext)(p);if(void 0===e)throw Error("useData must be used within a DataProvider");return e}}},function(e){e.O(0,[462,792,99,971,69,744],function(){return e(e.s=73318)}),_N_E=e.O()}]);