(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[823],{31982:function(e,a,o){Promise.resolve().then(o.bind(o,5259))},5259:function(e,a,o){"use strict";o.r(a),o.d(a,{default:function(){return x}});var r=o(3827),s=o(8792),c=o(53879),t=o(70699),i=o(80559),n=o(18994),l=o(28670),d=o(62457),u=o(48219),p=o(5590),h=o(64090),m=o(47907);function x(){let{addClient:e,showToast:a}=(0,p.e)(),o=(0,m.useRouter)(),[x,j]=(0,h.useState)(!1),[b,f]=(0,h.useState)(!1),[g,N]=(0,h.useState)({status:"Ativo",ultima_compra:"Nunca",tabelaPreco:"50a199",uf:"SP"}),v=e=>{let{name:a,value:o}=e.target;N(e=>({...e,[a]:o}))},y=async()=>{var e;let o=null===(e=g.cnpj)||void 0===e?void 0:e.replace(/\D/g,"");if(!o||14!==o.length){a("CNPJ inv\xe1lido (14 d\xedgitos)","error");return}j(!0);try{let e=await fetch("https://brasilapi.com.br/api/cnpj/v1/".concat(o));if(!e.ok)throw Error("CNPJ n\xe3o encontrado");let r=await e.json();N(e=>{var a;return{...e,razaoSocial:r.razao_social||e.razaoSocial,nomeFantasia:r.nome_fantasia||e.nomeFantasia,cep:(null===(a=r.cep)||void 0===a?void 0:a.replace(/\D/g,""))||e.cep,endereco:r.logradouro||e.endereco,numero:r.numero||e.numero,bairro:r.bairro||e.bairro,cidade:r.municipio||e.cidade,uf:r.uf||e.uf}}),a("Dados do CNPJ carregados!","success")}catch(e){a("CNPJ n\xe3o encontrado","error")}finally{j(!1)}},w=async()=>{var e;let o=null===(e=g.cep)||void 0===e?void 0:e.replace(/\D/g,"");if(!o||8!==o.length){a("CEP inv\xe1lido (8 d\xedgitos)","error");return}f(!0);try{let e=await fetch("https://viacep.com.br/ws/".concat(o,"/json/")),r=await e.json();if(r.erro)throw Error("CEP n\xe3o encontrado");N(e=>({...e,endereco:r.logradouro||e.endereco,bairro:r.bairro||e.bairro,cidade:r.localidade||e.cidade,uf:r.uf||e.uf})),a("Endere\xe7o carregado!","success")}catch(e){a("CEP n\xe3o encontrado","error")}finally{f(!1)}},E=r=>{if(r.preventDefault(),!g.razaoSocial||!g.cnpj){a("Preencha Raz\xe3o Social e CNPJ","error");return}e({id:Date.now().toString(),razaoSocial:g.razaoSocial||"",nomeFantasia:g.nomeFantasia||"",nome:g.razaoSocial||"",cnpj:g.cnpj||"",cidade:"".concat(g.cidade||"",", ").concat(g.uf||""),status:"Ativo",ultima_compra:"Nunca",...g}),o.push("/dashboard/clientes")};return(0,r.jsxs)("div",{className:"max-w-2xl mx-auto space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(s.default,{href:"/dashboard/clientes",className:"p-1.5 rounded-lg hover:bg-white/10 text-gray-400",children:(0,r.jsx)(c.Z,{className:"h-5 w-5"})}),(0,r.jsx)("h1",{className:"text-xl font-bold text-white",children:"Novo Cliente"})]}),(0,r.jsxs)("button",{onClick:E,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-1.5 text-sm font-medium text-white hover:bg-blue-500",children:[(0,r.jsx)(t.Z,{className:"h-4 w-4"})," Salvar"]})]}),(0,r.jsxs)("form",{className:"space-y-4",onSubmit:E,children:[(0,r.jsxs)("div",{className:"form-card",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-white/5",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4 text-blue-400"}),(0,r.jsx)("span",{className:"text-sm font-medium text-white",children:"Dados da Empresa"})]}),(0,r.jsxs)("div",{className:"grid gap-3 grid-cols-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"CNPJ *"}),(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)("input",{name:"cnpj",value:g.cnpj||"",onChange:v,placeholder:"00.000.000/0000-00",className:"input-compact flex-1"}),(0,r.jsx)("button",{type:"button",onClick:y,disabled:x,className:"px-2 rounded-lg bg-blue-600/20 text-blue-400 hover:bg-blue-600/30 disabled:opacity-50",title:"Buscar dados pelo CNPJ",children:x?(0,r.jsx)(n.Z,{className:"h-4 w-4 animate-spin"}):(0,r.jsx)(l.Z,{className:"h-4 w-4"})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Inscri\xe7\xe3o Estadual"}),(0,r.jsx)("input",{name:"inscricaoEstadual",value:g.inscricaoEstadual||"",onChange:v,placeholder:"Isento",className:"input-compact"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Raz\xe3o Social *"}),(0,r.jsx)("input",{name:"razaoSocial",value:g.razaoSocial||"",onChange:v,className:"input-compact"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Nome Fantasia"}),(0,r.jsx)("input",{name:"nomeFantasia",value:g.nomeFantasia||"",onChange:v,className:"input-compact"})]})]})]}),(0,r.jsxs)("div",{className:"form-card",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-white/5",children:[(0,r.jsx)(d.Z,{className:"h-4 w-4 text-orange-400"}),(0,r.jsx)("span",{className:"text-sm font-medium text-white",children:"Localiza\xe7\xe3o"})]}),(0,r.jsxs)("div",{className:"grid gap-3 grid-cols-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"CEP"}),(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)("input",{name:"cep",value:g.cep||"",onChange:v,placeholder:"00000-000",className:"input-compact flex-1"}),(0,r.jsx)("button",{type:"button",onClick:w,disabled:b,className:"px-2 rounded-lg bg-orange-600/20 text-orange-400 hover:bg-orange-600/30 disabled:opacity-50",title:"Buscar endere\xe7o pelo CEP",children:b?(0,r.jsx)(n.Z,{className:"h-4 w-4 animate-spin"}):(0,r.jsx)(l.Z,{className:"h-4 w-4"})})]})]}),(0,r.jsxs)("div",{className:"col-span-3",children:[(0,r.jsx)("label",{className:"label-compact",children:"Endere\xe7o"}),(0,r.jsx)("input",{name:"endereco",value:g.endereco||"",onChange:v,className:"input-compact"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"N\xfamero"}),(0,r.jsx)("input",{name:"numero",value:g.numero||"",onChange:v,className:"input-compact"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Bairro"}),(0,r.jsx)("input",{name:"bairro",value:g.bairro||"",onChange:v,className:"input-compact"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Cidade"}),(0,r.jsx)("input",{name:"cidade",value:g.cidade||"",onChange:v,className:"input-compact"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"UF"}),(0,r.jsxs)("select",{name:"uf",value:g.uf||"",onChange:v,className:"input-compact",children:[(0,r.jsx)("option",{value:"",children:"-"}),(0,r.jsx)("option",{children:"AC"}),(0,r.jsx)("option",{children:"AL"}),(0,r.jsx)("option",{children:"AP"}),(0,r.jsx)("option",{children:"AM"}),(0,r.jsx)("option",{children:"BA"}),(0,r.jsx)("option",{children:"CE"}),(0,r.jsx)("option",{children:"DF"}),(0,r.jsx)("option",{children:"ES"}),(0,r.jsx)("option",{children:"GO"}),(0,r.jsx)("option",{children:"MA"}),(0,r.jsx)("option",{children:"MT"}),(0,r.jsx)("option",{children:"MS"}),(0,r.jsx)("option",{children:"MG"}),(0,r.jsx)("option",{children:"PA"}),(0,r.jsx)("option",{children:"PB"}),(0,r.jsx)("option",{children:"PR"}),(0,r.jsx)("option",{children:"PE"}),(0,r.jsx)("option",{children:"PI"}),(0,r.jsx)("option",{children:"RJ"}),(0,r.jsx)("option",{children:"RN"}),(0,r.jsx)("option",{children:"RS"}),(0,r.jsx)("option",{children:"RO"}),(0,r.jsx)("option",{children:"RR"}),(0,r.jsx)("option",{children:"SC"}),(0,r.jsx)("option",{children:"SP"}),(0,r.jsx)("option",{children:"SE"}),(0,r.jsx)("option",{children:"TO"})]})]})]})]}),(0,r.jsxs)("div",{className:"form-card",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-white/5",children:[(0,r.jsx)(u.Z,{className:"h-4 w-4 text-green-400"}),(0,r.jsx)("span",{className:"text-sm font-medium text-white",children:"Perfil Comercial"})]}),(0,r.jsxs)("div",{className:"grid gap-3 grid-cols-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Tabela de Pre\xe7o"}),(0,r.jsxs)("select",{name:"tabelaPreco",value:g.tabelaPreco||"",onChange:v,className:"input-compact",children:[(0,r.jsx)("option",{value:"50a199",children:"50 a 199 CX"}),(0,r.jsx)("option",{value:"200a699",children:"200 a 699 CX"}),(0,r.jsx)("option",{value:"atacado",children:"Atacado"}),(0,r.jsx)("option",{value:"atacadoAVista",children:"Atacado \xe0 Vista"}),(0,r.jsx)("option",{value:"redes",children:"Redes"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"label-compact",children:"Limite de Cr\xe9dito (R$)"}),(0,r.jsx)("input",{name:"limiteCredito",type:"number",value:g.limiteCredito||"",onChange:v,placeholder:"0,00",className:"input-compact"})]}),(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsx)("label",{className:"label-compact",children:"Observa\xe7\xf5es"}),(0,r.jsx)("textarea",{name:"observacoes",rows:2,value:g.observacoes||"",onChange:v,className:"input-compact resize-none"})]})]})]})]})]})}},5590:function(e,a,o){"use strict";o.d(a,{F:function(){return h},e:function(){return m}});var r=o(3827),s=o(64090),c=o(46578),t=o(98998),i=o(28814),n=o(52235),l=o(28745),d=o(38371);function u(e){let{message:a,type:o,isVisible:u=!0,onClose:p}=e;return(0,s.useEffect)(()=>{if(u){let e=setTimeout(()=>{p()},3e3);return()=>clearTimeout(e)}},[u,p]),(0,r.jsx)(l.M,{children:u&&(0,r.jsxs)(d.E.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},className:"fixed bottom-6 right-6 z-50 flex items-center gap-3 rounded-xl border border-white/10 bg-black/80 px-4 py-3 text-sm text-white shadow-2xl backdrop-blur-md",children:[(0,r.jsxs)("div",{className:"rounded-full p-1 ".concat("success"===o?"bg-green-500/20 text-green-500":"error"===o?"bg-red-500/20 text-red-500":"bg-blue-500/20 text-blue-500"),children:["success"===o&&(0,r.jsx)(c.Z,{className:"h-4 w-4"}),"error"===o&&(0,r.jsx)(t.Z,{className:"h-4 w-4"}),"info"===o&&(0,r.jsx)(i.Z,{className:"h-4 w-4"})]}),(0,r.jsx)("span",{className:"font-medium pr-2",children:a}),(0,r.jsx)("button",{onClick:p,className:"ml-2 rounded-lg p-1 text-gray-400 hover:bg-white/10 hover:text-white transition-colors",children:(0,r.jsx)(n.Z,{className:"h-3 w-3"})})]})})}let p=(0,s.createContext)(void 0);function h(e){let{children:a}=e,[o,c]=(0,s.useState)([]),[t,i]=(0,s.useState)([]),[n,l]=(0,s.useState)([]),[d,h]=(0,s.useState)([]),[m,x]=(0,s.useState)(!0),[j,b]=(0,s.useState)(null),[f,g]=(0,s.useState)(null),N=(0,s.useCallback)((e,a)=>{g({message:e,type:a})},[]),v=(0,s.useCallback)(async()=>{x(!0);try{let[e,a,o,r]=await Promise.all([fetch("/api/clients"),fetch("/api/products"),fetch("/api/orders"),fetch("/api/fabricas")]);e.ok&&c(await e.json()),a.ok&&i(await a.json()),o.ok&&l(await o.json()),r.ok&&h(await r.json())}catch(e){console.error("Error fetching data:",e),N("Erro ao carregar dados","error")}finally{x(!1)}},[N]);(0,s.useEffect)(()=>{v();let e=localStorage.getItem("frplus_user");e&&b(e)},[v]);let y=async e=>{try{let a=await fetch("/api/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok){let e=await a.json();c(a=>[...a,e]),N("Cliente cadastrado com sucesso!","success")}else N("Erro ao cadastrar cliente","error")}catch(e){console.error("Error adding client:",e),N("Erro ao cadastrar cliente","error")}},w=async(e,a)=>{try{let o=await fetch("/api/clients/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(o.ok){let a=await o.json();c(o=>o.map(o=>o.id===e?a:o)),N("Cliente atualizado com sucesso!","success")}}catch(e){console.error("Error updating client:",e),N("Erro ao atualizar cliente","error")}},E=async e=>{try{(await fetch("/api/clients/".concat(e),{method:"DELETE"})).ok&&(c(a=>a.filter(a=>a.id!==e)),N("Cliente exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing client:",e),N("Erro ao excluir cliente","error")}},C=async e=>{try{(await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await v(),N("Produto cadastrado com sucesso!","success")):N("Erro ao cadastrar produto","error")}catch(e){console.error("Error adding product:",e),N("Erro ao cadastrar produto","error")}},S=async(e,a)=>{try{(await fetch("/api/products/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok&&(await v(),N("Produto atualizado com sucesso!","success"))}catch(e){console.error("Error updating product:",e),N("Erro ao atualizar produto","error")}},P=async e=>{try{(await fetch("/api/products/".concat(e),{method:"DELETE"})).ok&&(i(a=>a.filter(a=>a.id!==e)),N("Produto exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing product:",e),N("Erro ao excluir produto","error")}},k=async e=>{try{(await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await v(),N("Pedido cadastrado com sucesso!","success")):N("Erro ao cadastrar pedido","error")}catch(e){console.error("Error adding order:",e),N("Erro ao cadastrar pedido","error")}},T=async(e,a)=>{try{(await fetch("/api/orders/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok&&(await v(),N("Pedido atualizado com sucesso!","success"))}catch(e){console.error("Error updating order:",e),N("Erro ao atualizar pedido","error")}},z=async e=>{try{(await fetch("/api/orders/".concat(e),{method:"DELETE"})).ok&&(l(a=>a.filter(a=>a.id!==e)),N("Pedido exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing order:",e),N("Erro ao excluir pedido","error")}},O=async e=>{try{let a=await fetch("/api/fabricas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok){let e=await a.json();h(a=>[...a,e]),N("F\xe1brica cadastrada com sucesso!","success")}}catch(e){console.error("Error adding fabrica:",e),N("Erro ao cadastrar f\xe1brica","error")}},J=async(e,a)=>{try{(await fetch("/api/fabricas/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok&&(await v(),N("F\xe1brica atualizada com sucesso!","success"))}catch(e){console.error("Error updating fabrica:",e),N("Erro ao atualizar f\xe1brica","error")}},D=async e=>{try{(await fetch("/api/fabricas/".concat(e),{method:"DELETE"})).ok&&(h(a=>a.filter(a=>a.id!==e)),N("F\xe1brica exclu\xedda com sucesso!","success"))}catch(e){console.error("Error removing fabrica:",e),N("Erro ao excluir f\xe1brica","error")}};return(0,r.jsxs)(p.Provider,{value:{clients:o,products:t,orders:n,fabricas:d,loading:m,addClient:y,updateClient:w,removeClient:E,addProduct:C,updateProduct:S,removeProduct:P,addOrder:k,updateOrder:T,removeOrder:z,addFabrica:O,updateFabrica:J,removeFabrica:D,getDashboardStats:()=>({totalSales:n.reduce((e,a)=>e+a.valorTotal,0),totalOrders:n.length,newClients:o.length,totalProducts:t.length}),showToast:N,user:j,login:e=>{b(e),localStorage.setItem("frplus_user",e)},logout:()=>{b(null),localStorage.removeItem("frplus_user")},refreshData:v},children:[a,f&&(0,r.jsx)(u,{message:f.message,type:f.type,onClose:()=>g(null)})]})}function m(){let e=(0,s.useContext)(p);if(void 0===e)throw Error("useData must be used within a DataProvider");return e}}},function(e){e.O(0,[462,792,99,971,69,744],function(){return e(e.s=31982)}),_N_E=e.O()}]);