(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[891],{54389:function(e,a,r){Promise.resolve().then(r.bind(r,69007))},69007:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return x}});var s=r(3827),t=r(8792),o=r(53879),c=r(70699),i=r(65561),l=r(4697),n=r(10632),d=r(95132),m=r(48219),u=r(5590),p=r(64090),h=r(47907);function x(e){let{params:a}=e,{products:r,updateProduct:x,showToast:f,fabricas:g}=(0,u.e)(),b=(0,h.useRouter)(),[j,y]=(0,p.useState)({});(0,p.useEffect)(()=>{let e=r.find(e=>e.id===a.id);e&&y(e)},[r,a.id]);let N=e=>{let{name:a,value:r}=e.target,s=["preco50a199","preco200a699","precoAtacado","precoAtacadoAVista","precoRedes"];y(e=>({...e,[a]:s.includes(a)?parseFloat(r)||0:r}))},v=e=>{if(e.preventDefault(),!j.nome||!j.codigo){f("Preencha Nome e C\xf3digo","error");return}if(j.id){let e={...j,imagem:j.imagemUrl||j.imagem};x(j.id,e),b.push("/dashboard/produtos")}};return(0,s.jsxs)("div",{className:"max-w-2xl mx-auto space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(t.default,{href:"/dashboard/produtos",className:"p-1.5 rounded-lg hover:bg-white/10 text-gray-400",children:(0,s.jsx)(o.Z,{className:"h-5 w-5"})}),(0,s.jsx)("h1",{className:"text-xl font-bold text-white",children:"Editar Produto"})]}),(0,s.jsxs)("button",{onClick:v,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-1.5 text-sm font-medium text-white hover:bg-blue-500",children:[(0,s.jsx)(c.Z,{className:"h-4 w-4"})," Salvar"]})]}),(0,s.jsxs)("form",{className:"space-y-4",onSubmit:v,children:[(0,s.jsxs)("div",{className:"form-card",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-white/5",children:[(0,s.jsx)(i.Z,{className:"h-4 w-4 text-pink-400"}),(0,s.jsx)("span",{className:"text-sm font-medium text-white",children:"Foto do Produto"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-24 h-24 rounded-lg border-2 border-dashed border-white/20 bg-white/5 flex items-center justify-center overflow-hidden",children:j.imagemUrl?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("img",{src:j.imagemUrl,alt:"Preview",className:"w-full h-full object-cover"})}):(0,s.jsx)(l.Z,{className:"h-8 w-8 text-gray-500"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-white/5 border border-white/10 hover:bg-white/10 cursor-pointer transition-colors",children:[(0,s.jsx)(n.Z,{className:"h-4 w-4 text-gray-400"}),(0,s.jsx)("span",{className:"text-sm text-gray-300",children:"Escolher imagem"}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var a;let r=null===(a=e.target.files)||void 0===a?void 0:a[0];if(r){let e=new FileReader;e.onloadend=()=>{y(a=>({...a,imagemUrl:e.result}))},e.readAsDataURL(r)}},className:"hidden"})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"PNG, JPG ou WEBP at\xe9 2MB"}),(0,s.jsx)("input",{type:"text",name:"imagemUrl",value:j.imagemUrl||"",onChange:N,placeholder:"Ou cole a URL da imagem aqui...",className:"input-compact mt-2 text-xs"})]})]})]}),(0,s.jsxs)("div",{className:"form-card",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-white/5",children:[(0,s.jsx)(l.Z,{className:"h-4 w-4 text-purple-400"}),(0,s.jsx)("span",{className:"text-sm font-medium text-white",children:"Identifica\xe7\xe3o"})]}),(0,s.jsxs)("div",{className:"grid gap-3 grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label-compact",children:"C\xf3digo *"}),(0,s.jsx)("input",{name:"codigo",value:j.codigo||"",onChange:N,className:"input-compact"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label-compact",children:"Nome *"}),(0,s.jsx)("input",{name:"nome",value:j.nome||"",onChange:N,className:"input-compact"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label-compact",children:"F\xe1brica"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(d.Z,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-3 w-3 text-gray-500"}),(0,s.jsxs)("select",{name:"fabricaId",value:j.fabricaId||"",onChange:N,className:"input-compact pl-7",children:[(0,s.jsx)("option",{value:"",children:"Selecione..."}),g.map(e=>(0,s.jsx)("option",{value:e.id,children:e.nome},e.id))]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label-compact",children:"Categoria"}),(0,s.jsx)("input",{name:"categoria",value:j.categoria||"",onChange:N,className:"input-compact"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label-compact",children:"Unidade"}),(0,s.jsxs)("select",{name:"unidade",value:j.unidade||"CX",onChange:N,className:"input-compact",children:[(0,s.jsx)("option",{value:"CX",children:"Caixa (CX)"}),(0,s.jsx)("option",{value:"UN",children:"Unidade (UN)"}),(0,s.jsx)("option",{value:"KG",children:"Quilo (KG)"}),(0,s.jsx)("option",{value:"LT",children:"Litro (LT)"}),(0,s.jsx)("option",{value:"PCT",children:"Pacote (PCT)"})]})]})]})]}),(0,s.jsxs)("div",{className:"form-card",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-white/5",children:[(0,s.jsx)(m.Z,{className:"h-4 w-4 text-green-400"}),(0,s.jsx)("span",{className:"text-sm font-medium text-white",children:"Tabelas de Pre\xe7o (R$)"})]}),(0,s.jsxs)("div",{className:"grid gap-3 grid-cols-5",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label-compact",children:"50 a 199 CX"}),(0,s.jsx)("input",{name:"preco50a199",type:"number",step:"0.01",value:j.preco50a199||"",onChange:N,className:"input-compact"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label-compact",children:"200 a 699 CX"}),(0,s.jsx)("input",{name:"preco200a699",type:"number",step:"0.01",value:j.preco200a699||"",onChange:N,className:"input-compact"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label-compact",children:"Atacado"}),(0,s.jsx)("input",{name:"precoAtacado",type:"number",step:"0.01",value:j.precoAtacado||"",onChange:N,className:"input-compact"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label-compact",children:"Atacado \xe0 Vista"}),(0,s.jsx)("input",{name:"precoAtacadoAVista",type:"number",step:"0.01",value:j.precoAtacadoAVista||"",onChange:N,className:"input-compact"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label-compact",children:"Redes"}),(0,s.jsx)("input",{name:"precoRedes",type:"number",step:"0.01",value:j.precoRedes||"",onChange:N,className:"input-compact"})]})]})]})]})]})}},5590:function(e,a,r){"use strict";r.d(a,{F:function(){return p},e:function(){return h}});var s=r(3827),t=r(64090),o=r(46578),c=r(98998),i=r(28814),l=r(52235),n=r(28745),d=r(38371);function m(e){let{message:a,type:r,isVisible:m=!0,onClose:u}=e;return(0,t.useEffect)(()=>{if(m){let e=setTimeout(()=>{u()},3e3);return()=>clearTimeout(e)}},[m,u]),(0,s.jsx)(n.M,{children:m&&(0,s.jsxs)(d.E.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},className:"fixed bottom-6 right-6 z-50 flex items-center gap-3 rounded-xl border border-white/10 bg-black/80 px-4 py-3 text-sm text-white shadow-2xl backdrop-blur-md",children:[(0,s.jsxs)("div",{className:"rounded-full p-1 ".concat("success"===r?"bg-green-500/20 text-green-500":"error"===r?"bg-red-500/20 text-red-500":"bg-blue-500/20 text-blue-500"),children:["success"===r&&(0,s.jsx)(o.Z,{className:"h-4 w-4"}),"error"===r&&(0,s.jsx)(c.Z,{className:"h-4 w-4"}),"info"===r&&(0,s.jsx)(i.Z,{className:"h-4 w-4"})]}),(0,s.jsx)("span",{className:"font-medium pr-2",children:a}),(0,s.jsx)("button",{onClick:u,className:"ml-2 rounded-lg p-1 text-gray-400 hover:bg-white/10 hover:text-white transition-colors",children:(0,s.jsx)(l.Z,{className:"h-3 w-3"})})]})})}let u=(0,t.createContext)(void 0);function p(e){let{children:a}=e,[r,o]=(0,t.useState)([]),[c,i]=(0,t.useState)([]),[l,n]=(0,t.useState)([]),[d,p]=(0,t.useState)([]),[h,x]=(0,t.useState)(!0),[f,g]=(0,t.useState)(null),[b,j]=(0,t.useState)(null),y=(0,t.useCallback)((e,a)=>{j({message:e,type:a})},[]),N=(0,t.useCallback)(async()=>{x(!0);try{let[e,a,r,s]=await Promise.all([fetch("/api/clients"),fetch("/api/products"),fetch("/api/orders"),fetch("/api/fabricas")]);e.ok&&o(await e.json()),a.ok&&i(await a.json()),r.ok&&n(await r.json()),s.ok&&p(await s.json())}catch(e){console.error("Error fetching data:",e),y("Erro ao carregar dados","error")}finally{x(!1)}},[y]);(0,t.useEffect)(()=>{N();let e=localStorage.getItem("frplus_user");e&&g(e)},[N]);let v=async e=>{try{let a=await fetch("/api/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok){let e=await a.json();o(a=>[...a,e]),y("Cliente cadastrado com sucesso!","success")}else y("Erro ao cadastrar cliente","error")}catch(e){console.error("Error adding client:",e),y("Erro ao cadastrar cliente","error")}},w=async(e,a)=>{try{let r=await fetch("/api/clients/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(r.ok){let a=await r.json();o(r=>r.map(r=>r.id===e?a:r)),y("Cliente atualizado com sucesso!","success")}}catch(e){console.error("Error updating client:",e),y("Erro ao atualizar cliente","error")}},E=async e=>{try{(await fetch("/api/clients/".concat(e),{method:"DELETE"})).ok&&(o(a=>a.filter(a=>a.id!==e)),y("Cliente exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing client:",e),y("Erro ao excluir cliente","error")}},C=async e=>{try{(await fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await N(),y("Produto cadastrado com sucesso!","success")):y("Erro ao cadastrar produto","error")}catch(e){console.error("Error adding product:",e),y("Erro ao cadastrar produto","error")}},P=async(e,a)=>{try{(await fetch("/api/products/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok&&(await N(),y("Produto atualizado com sucesso!","success"))}catch(e){console.error("Error updating product:",e),y("Erro ao atualizar produto","error")}},S=async e=>{try{(await fetch("/api/products/".concat(e),{method:"DELETE"})).ok&&(i(a=>a.filter(a=>a.id!==e)),y("Produto exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing product:",e),y("Erro ao excluir produto","error")}},T=async e=>{try{(await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(await N(),y("Pedido cadastrado com sucesso!","success")):y("Erro ao cadastrar pedido","error")}catch(e){console.error("Error adding order:",e),y("Erro ao cadastrar pedido","error")}},k=async(e,a)=>{try{(await fetch("/api/orders/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok&&(await N(),y("Pedido atualizado com sucesso!","success"))}catch(e){console.error("Error updating order:",e),y("Erro ao atualizar pedido","error")}},O=async e=>{try{(await fetch("/api/orders/".concat(e),{method:"DELETE"})).ok&&(n(a=>a.filter(a=>a.id!==e)),y("Pedido exclu\xeddo com sucesso!","success"))}catch(e){console.error("Error removing order:",e),y("Erro ao excluir pedido","error")}},U=async e=>{try{let a=await fetch("/api/fabricas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok){let e=await a.json();p(a=>[...a,e]),y("F\xe1brica cadastrada com sucesso!","success")}}catch(e){console.error("Error adding fabrica:",e),y("Erro ao cadastrar f\xe1brica","error")}},A=async(e,a)=>{try{(await fetch("/api/fabricas/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok&&(await N(),y("F\xe1brica atualizada com sucesso!","success"))}catch(e){console.error("Error updating fabrica:",e),y("Erro ao atualizar f\xe1brica","error")}},Z=async e=>{try{(await fetch("/api/fabricas/".concat(e),{method:"DELETE"})).ok&&(p(a=>a.filter(a=>a.id!==e)),y("F\xe1brica exclu\xedda com sucesso!","success"))}catch(e){console.error("Error removing fabrica:",e),y("Erro ao excluir f\xe1brica","error")}};return(0,s.jsxs)(u.Provider,{value:{clients:r,products:c,orders:l,fabricas:d,loading:h,addClient:v,updateClient:w,removeClient:E,addProduct:C,updateProduct:P,removeProduct:S,addOrder:T,updateOrder:k,removeOrder:O,addFabrica:U,updateFabrica:A,removeFabrica:Z,getDashboardStats:()=>({totalSales:l.reduce((e,a)=>e+a.valorTotal,0),totalOrders:l.length,newClients:r.length,totalProducts:c.length}),showToast:y,user:f,login:e=>{g(e),localStorage.setItem("frplus_user",e)},logout:()=>{g(null),localStorage.removeItem("frplus_user")},refreshData:N},children:[a,b&&(0,s.jsx)(m,{message:b.message,type:b.type,onClose:()=>j(null)})]})}function h(){let e=(0,t.useContext)(u);if(void 0===e)throw Error("useData must be used within a DataProvider");return e}}},function(e){e.O(0,[462,792,724,971,69,744],function(){return e(e.s=54389)}),_N_E=e.O()}]);